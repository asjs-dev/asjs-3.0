(function(){var $="createPrototypeClass,property,AbstractFilter,createBlendMode,updateId,BasePrototypeClass,_locations,_height,destruct,_width,_currentAdditionalPropsUpdateId,_createArrayBuffer,_bindArrayBuffer,_extensionData,height,emptyFunction,_currentRenderTime,_sourceWidthProperty,_source,_currentUpdateId,matrixCache,_lightData,_batchItems,createVersion,propsUpdateId,AbstractPositioningProps,isNeedToDraw,_currentParentPropsUpdateId,_currentParentColorUpdateId,precision,_updateAdditionalData,_currentColorUpdateId,_sourceHeightProperty,children,_rotationUpdateId,_renderTime,_resizeFunc,createFragmentShader,maxTextureImageUnits,_setBufferData,_scaleUpdateId,texture,_parent,locations,_program,useTexture,clearColor,AbstractProps,_initCustom,createVertexShader,_clearBeforeRenderFunc,BaseRenderer,_maxBatchItems,BatchRendererBase,_resize,_currentTexturePropsUpdateId,isContextLost,AbstractDrawable,_drawFunctionMap,_onTextureLoadedBind,textureCrop,lightRenderer,arraySet,_currentClearColorUpdateId,_fragmentShader,_rotation,updateAnimation,_updateId,_bindBuffers,scaledHeight,colorCache,_attachFramebuffer,filterRenderer,FilterRenderer,createGetTextureFunction,_currentRotationUpdateId,_config,scaledWidth,unbindFrameBuffer,_matrixData,_textureMap,baseTexture,texParameteri,LightRenderer,_vertexShader,useActiveTexture,_texturesEnabled,addEventListener,_parentColorData,_updateTransform,_currentPropsUpdateId,deepFreeze,_currentScaleUpdateId,_batchDraw,useProgram,sinRotationB,_updateProps,cosRotationA,cosRotationB,sinRotationA,bindFramebuffer,_destroyTexture,_effectData,TextureInfo,removeChild,bindTexture,_destroyFramebuffer,_inverseMatrixCache,Container,_maskData,SimpleRenderer,_textureIdData,_tintColorData,_framebufferTempId,destructObjectFlat,textureMatrixCache,_allowTransparency,loadFragmentShader,colorUpdateId,getChildIndex,_framebuffers,_useBlendMode,setChildIndex,bindBuffer,initConfig,_eventType,allowTransparency,_alphaData,_parseTextureSize,_useShadowTexture,_currentBlendMode,shadowLength,createBuffer,_updateColor,_renderBatch,_drawTexture,loadVertexShader,_updateAnimation,_useTextureFrame,shadowStart,_loseContextExt,enableVertexAttribArray,framebuffer,_blurFilter,_textureIds,pickerPoint,calcGlPositions,removeFromArray,transition,updateRotation,hasOwnProperty,intensityY,drawElementsInstanced,bufferData,heightHalf,_currentFilterTexture,_minFilter,createProgram,_shadowLength,_renderSource,_setBlendMode,container,createElement,removeEventListener,_calcCorners,deleteShader,_isPickerSet,shouldUpdate,_shadowStart,createCanvas,destroyFramebuffer,_parentColorBuffer,_attachArrayBuffer,bindActiveTexture,readystatechange,contextAttributes,textureCropCache,_textureIdBuffer,_tintColorBuffer,_destructContext,_onTextureLoaded,_extensionBuffer,_minMipmapFilter,minMipmapFilter".split(",");var $n=null,$u=undefined,$c=console,$w=window,$d=document,$o=Object;"use strict";var helpers={};var _=helpers;_[$[147]]=function(c,b){var d=c.indexOf(b);d>-1&&c.splice(d,1)};_[$[62]]=function(c,d,b){var i=d.length;while(--i>-1)c[b+i]=d[i]};_[$[1]]=function(d,b,f){f.enumerable=!0;f.configurable=!0;$o.defineProperty(d,b,f)};_.get=function(d,b,c){_[$[1]](d,b,{get:c})};_.set=function(d,b,c){_[$[1]](d,b,{set:c})};_.isEmpty=function(b){try{return b===$u||b===$n||b===""||b.length===0}catch(e){return!0}};_.map=function(d,f){for(var b in d){if(!d[$[150]](b))continue;var c=f(b,d[b]);if(!_.isEmpty(c))d[b]=c}};_[$[15]]=function(){};_[$[0]]=function(c,g,b){var d=c.prototype;var f=g.prototype;$o.setPrototypeOf(g,c);$o.setPrototypeOf(f,d);b&&b.call(f,f,d);return g};_.iterateOver=function(h,j,k){if(_.isEmpty(h))return c();var d=$o.keys(h);var b;var i=-1;function c(){k&&k()};function f(){i++;if(i===d.length){c();return};b=d[i];if(h[$[150]]&&!h[$[150]](b))f();var g;try{g=h[b]}catch(e){};var v=j(b,g,f,c);if(!_.isEmpty(v))h[b]=v};f()};_.deleteProperty=function(c,b){var d=$o.getOwnPropertyDescriptor(c,b);if(d&&(d.get||d.set))_[$[1]](c,b,{set:_[$[15]],get:_[$[15]]});else{try{c[b]=$n}catch(e){}};delete c[b]};_.typeIs=function(c,b){return typeof c===b};_[$[114]]=function(g,f){var f=f||[];_.iterateOver(g,function(b,c,d){var h=c&&_.typeIs(c,"object")&&!c.length;if(!h||f.indexOf(c)<0){f.push(c);h&&_[$[114]](c,f);_.deleteProperty(g,b)};d()});g=f=$n};_[$[5]]=_[$[0]]($o,function b(){},function(){this[$[8]]=function(){_[$[114]](this)};this.toObject=function(){return JSON.parse(JSON.stringify(this))}});_[$[91]]=function(b){var f=$o.getOwnPropertyNames(b);for(var c of f){var d=b[c];d&&_.typeIs(d,"object")&&_[$[91]](d)};return $o.freeze(b)};$c.log("AGL 1.0");var F32A=Float32Array;$w.AGL={};AGL.Utils=new(_[$[0]](_[$[5]],function g(){_[$[5]].call(this);this[$[136]]=this.loadShader.bind(this,"VERTEX_SHADER");this[$[117]]=this.loadShader.bind(this,"FRAGMENT_SHADER");this.info={isWebGl2Supported:!1};$w[$[87]]("beforeunload",this.onBeforeUnload.bind(this))},function(q){q[$[124]]=function(k,p){k=k||{};var C=k[$[175]]||{};return{canvas:k.canvas||AGL.Utils[$[169]](k.isOffscreen),locations:(k[$[43]]||[]).concat(["uFlpY","aPos","uTex"]),vertexShader:k.vertexShader||p[$[49]],fragmentShader:k.fragmentShader||p[$[37]],precision:k[$[29]]||"lowp",contextAttributes:{alpha:C.alpha||!1,antialias:C.antialias||!1,depth:C.depth||!1,stencil:C.stencil||!1,premultipliedAlpha:C.premultipliedAlpha||!1,powerPreference:C.powerPreference||"high-performance",preserveDrawingBuffer:C.preserveDrawingBuffer||!0,}}};q.pointsOrder=new Uint16Array([0,1,2,0,2,3]);q[$[23]]=function(z){return"#version 300 es\nprecision "+z+" float;\n"};q[$[74]]=function(L){var d="vec4 gtTexCol(float i,vec2 c){";for(var i=0;i<L;++i)d+=(i>0?"else ":"")+"if(i<"+(i+1)+".)return texture(uTex["+i+"],c);";d+="return vec4(0);}";return d};q.getTexColor="fgCol=gtTexCol(vTexId,vTexCrop.xy+vTexCrop.zw*mod(vTCrd,1.));";q[$[146]]="mat3 mt=mat3(aMt[0].xy,0,aMt[0].zw,0,aMt[1].xy,1);mat3 tMt=mat3(aMt[1].zw,0,aMt[2].xy,0,aMt[2].zw,1);vec3 pos=vec3(aPos,1);gl_Position=vec4(mt*pos,1);gl_Position.y*=uFlpY;vTCrd=(tMt*pos).xy;vTexCrop=aMt[3];";q[$[169]]=function(J){return J&&$w.OffscreenCanvas?new $w.OffscreenCanvas(1,1):$d[$[162]]("canvas")};q.initApplication=function(w){function E(l){if($d.readyState==="complete"){$d[$[87]]($[174],I);var b=this[$[169]](!0).getContext("webgl2");if(b){this.info.isWebGl2Supported=!0;this.info[$[38]]=b.getParameter(34930)};b=$n;w(this.info.isWebGl2Supported)}else if(!l)$d[$[87]]($[174],I)};var I=E.bind(this,!0);E()};q[$[85]]=function(b,D,h){b.activeTexture(33984+h);this[$[45]](b,D)};q[$[173]]=function(b,D,h){b.activeTexture(33984+h);this[$[105]](b,D)};q.bindFrameBuffer=function(b,D){b[$[100]](36160,D[$[142]])};q[$[78]]=function(b){b[$[100]](36160,$n)};q[$[45]]=function(b,D){this[$[105]](b,D);this.uploadTexture(b,D)};q.uploadTexture=function(b,D){b.texImage2D(D.target,0,D.internalFormat,D.width,D[$[14]],0,D.format,5121,D.renderSource);b[$[82]](D.target,33085,0);b.generateMipmap(D.target)};q[$[105]]=function(b,D){b[$[105]](D.target,D[$[81]]);b[$[82]](D.target,10242,D.wrapS);b[$[82]](D.target,10243,D.wrapT);b[$[82]](D.target,10241,D[$[183]]);b[$[82]](D.target,10240,D.magFilter)};q.loadShader=function(B,b,G){var r=b.createShader(b[B]);b.shaderSource(r,G);b.compileShader(r);var x=b.getShaderParameter(r,35713);if(!x){var y=b.getShaderInfoLog(r);$c.log("Error compiling shader "+B+": "+y);b[$[165]](r);return $n};return r};q[$[157]]=function(b,v,s,A){var t=b[$[157]]();_.map(v,function(c,r){b.attachShader(t,r)});if(s){_.map(s,function(c,n){b.bindAttribLocation(t,A?A[c]:c,n)})};b.linkProgram(t);var m=b.getProgramParameter(t,35714);if(!m){var y=b.getProgramInfoLog(t);$c.log("Error in program linking: "+y);b.deleteProgram(t);return $n};return t};q.getLocationsFor=function(b,t,K){var H={a:"Attrib",u:"Uniform"};var A={};_.map(K,function(c,f){A[f]=b["get"+H[f[0]]+"Location"](t,f)});return A};q.destroyTexture=function(b,D){if(b&&D&&D[$[81]]){b[$[105]](D.target,$n);b.deleteTexture(D[$[81]])}};q[$[170]]=function(b,F){if(b&&F){b[$[100]](36160,$n);b.deleteFramebuffer(F)}};q.isPowerOf2=function(j){return(j&(j-1))==0};q.onBeforeUnload=function(){this[$[136]]=this[$[117]]=this.info=$n;this[$[8]]()}}))();AGL[$[3]]=function(c,b){return{funcName:"blendFunc"+(c.length<3?"":"Separate"),funcs:c,eqName:"blendEquation"+(!b||b.length<2?"":"Separate"),eqs:b||[32774]}};AGL.BlendMode=_[$[91]]({NONE:AGL[$[3]]([0,0]),SIMPLE:AGL[$[3]]([1,1]),NORMAL_PM:AGL[$[3]]([1,771]),ADD_PM:AGL[$[3]]([1,1]),MULTIPLY_PM:AGL[$[3]]([774,771,1,771]),SCREEN_PM:AGL[$[3]]([1,769,1,771]),ADD_NPM:AGL[$[3]]([770,1,1,1]),SRC_IN:AGL[$[3]]([772,0]),SRC_OUT:AGL[$[3]]([773,0]),SRC_ATOP:AGL[$[3]]([772,771]),DST_OVER:AGL[$[3]]([773,1]),DST_IN:AGL[$[3]]([0,770]),DST_OUT:AGL[$[3]]([0,771]),DST_ATOP:AGL[$[3]]([773,770]),XOR:AGL[$[3]]([773,771]),NORMAL:AGL[$[3]]([770,771,1,771]),ADD:AGL[$[3]]([770,772,1,772]),MULTIPLY:AGL[$[3]]([774,771]),SCREEN:AGL[$[3]]([770,769,1,769]),OVERLAY:AGL[$[3]]([1,771]),EXCLUSION:AGL[$[3]]([775,769])});AGL[$[47]]=_[$[0]]($o,function b(){this[$[4]]=0},function(){});AGL[$[25]]=_[$[0]](AGL[$[47]],function f(){AGL[$[47]].call(this);this[$[34]]=this[$[75]]=this[$[99]]=this[$[95]]=this._x=this._y=this._z=this[$[65]]=this._anchorX=this._anchorY=this._skewX=this._skewY=0;this[$[97]]=this[$[98]]=1},function(b){_[$[1]](b,"x",{get:function(){return this._x},set:function(v){if(this._x!==v){this._x=v;++this[$[4]]}}});_[$[1]](b,"y",{get:function(){return this._y},set:function(v){if(this._y!==v){this._y=v;++this[$[4]]}}});_[$[1]](b,"z",{get:function(){return this._z},set:function(v){if(this._z!==v){this._z=v;++this[$[4]]}}});_[$[1]](b,"rotation",{get:function(){return this[$[65]]},set:function(v){if(this[$[65]]!==v){this[$[65]]=v;++this[$[34]]}}});_[$[1]](b,"anchorX",{get:function(){return this._anchorX},set:function(v){if(this._anchorX!==v){this._anchorX=v;++this[$[4]]}}});_[$[1]](b,"anchorY",{get:function(){return this._anchorY},set:function(v){if(this._anchorY!==v){this._anchorY=v;++this[$[4]]}}});_[$[1]](b,"skewX",{get:function(){return this._skewX},set:function(v){if(this._skewX!==v){this._skewX=v;++this[$[34]]}}});_[$[1]](b,"skewY",{get:function(){return this._skewY},set:function(v){if(this._skewY!==v){this._skewY=v;++this[$[34]]}}});b[$[149]]=function(){if(this[$[75]]<this[$[34]]){this[$[75]]=this[$[34]];++this[$[4]];if(this._skewX===0&&this._skewY===0){this[$[99]]=this[$[95]]=Math.sin(this[$[65]]);this[$[97]]=this[$[98]]=Math.cos(this[$[65]])}else{var c=this[$[65]]-this._skewX;var d=this[$[65]]+this._skewY;this[$[99]]=Math.sin(d);this[$[97]]=Math.cos(d);this[$[95]]=Math.sin(c);this[$[98]]=Math.cos(c)}}}});AGL.ColorProps=_[$[0]](AGL[$[47]],function f(){AGL[$[47]].call(this);this.items=[1,1,1,1]},function(d){_[$[1]](d,"r",{get:function(){return this.items[0]},set:function(c){if(this.items[0]!==c){this.items[0]=c;++this[$[4]]}}});_[$[1]](d,"g",{get:function(){return this.items[1]},set:function(c){if(this.items[1]!==c){this.items[1]=c;++this[$[4]]}}});_[$[1]](d,"b",{get:function(){return this.items[2]},set:function(c){if(this.items[2]!==c){this.items[2]=c;++this[$[4]]}}});_[$[1]](d,"a",{get:function(){return this.items[3]},set:function(c){if(this.items[3]!==c){this.items[3]=c;++this[$[4]]}}});d.set=function(r,g,b,a){this.r=r;this.g=g;this.b=b;this.a=a}});AGL.ItemProps=_[$[0]](AGL[$[25]],function c(){AGL[$[25]].call(this);this[$[40]]=this[$[92]]=0;this[$[77]]=this[$[69]]=this._scaleX=this._scaleY=this[$[9]]=this[$[7]]=this.alpha=1},function(b){_[$[1]](b,"scaleX",{get:function(){return this._scaleX},set:function(v){if(this._scaleX!==v){this._scaleX=v;++this[$[40]]}}});_[$[1]](b,"scaleY",{get:function(){return this._scaleY},set:function(v){if(this._scaleY!==v){this._scaleY=v;++this[$[40]]}}});_[$[1]](b,"width",{get:function(){return this[$[9]]},set:function(v){if(this[$[9]]!==v){this[$[9]]=v;++this[$[40]]}}});_[$[1]](b,$[14],{get:function(){return this[$[7]]},set:function(v){if(this[$[7]]!==v){this[$[7]]=v;++this[$[40]]}}});b.updateScale=function(){if(this[$[92]]<this[$[40]]){this[$[92]]=this[$[40]];++this[$[4]];this[$[77]]=this[$[9]]*this._scaleX;this[$[69]]=this[$[7]]*this._scaleY}}});AGL.TextureCrop=_[$[0]](AGL[$[47]],function c(){AGL[$[47]].call(this);this[$[19]]=0;this.items=[0,0,1,1];this[$[9]]=this[$[7]]=1},function(b){_[$[1]](b,"x",{get:function(){return this.items[0]},set:function(v){if(this.items[0]!==v){this.items[0]=v;++this[$[4]]}}});_[$[1]](b,"y",{get:function(){return this.items[1]},set:function(v){if(this.items[1]!==v){this.items[1]=v;++this[$[4]]}}});_[$[1]](b,"width",{get:function(){return this[$[9]]},set:function(v){if(this[$[9]]!==v){this[$[9]]=v;++this[$[4]]}}});_[$[1]](b,$[14],{get:function(){return this[$[7]]},set:function(v){if(this[$[7]]!==v){this[$[7]]=v;++this[$[4]]}}});b.updateCrop=function(){if(this[$[19]]<this[$[4]]){this[$[19]]=this[$[4]];this.items[2]=this[$[9]]-this.items[0];this.items[3]=this[$[7]]-this.items[1]}}});AGL.TextureProps=_[$[0]](AGL[$[25]],function c(){AGL[$[25]].call(this);this[$[9]]=this[$[7]]=this[$[77]]=this[$[69]]=1},function(b){_[$[1]](b,"width",{get:function(){return this[$[9]]},set:function(v){if(this[$[9]]!==v){this[$[77]]=this[$[9]]=v;++this[$[4]]}}});_[$[1]](b,$[14],{get:function(){return this[$[7]]},set:function(v){if(this[$[7]]!==v){this[$[69]]=this[$[7]]=v;++this[$[4]]}}})});AGL[$[103]]=_[$[0]](_[$[5]],function g(h){_[$[5]].call(this);this.target=3553;this[$[167]]=h;this[$[67]]=this[$[19]]=this[$[16]]=0;this.wrapS=this.wrapT=33071;this.internalFormat=this.format=6408;this.minFilter=this.magFilter=9728;this[$[9]]=this[$[7]]=1},function(c,d){_.get(c,"loaded",function(){return this._loaded});_.get(c,"width",function(){return this[$[9]]});_.get(c,$[14],function(){return this[$[7]]});_.get(c,$[183],function(){return this[$[182]]});_[$[1]](c,"minFilter",{get:function(){return this[$[156]]},set:function(v){if(this[$[156]]!==v){this[$[156]]=v;this[$[182]]=this[$[156]]===9729?9987:9984}}});c[$[26]]=function(b,f){if(this.gl!==b){this[$[101]]();this[$[81]]=b.createTexture();this.gl=b;return!0};if(this[$[167]]&&this[$[16]]<f){this[$[16]]=f;return!0};if(this[$[19]]<this[$[67]]){this[$[19]]=this[$[67]];return!0};return!1};c[$[8]]=function(){this[$[101]]();d[$[8]].call(this)};c[$[101]]=function(){AGL.Utils.destroyTexture(this.gl,this)}});AGL.Texture=_[$[0]](AGL[$[103]],function l(h,p){AGL[$[103]].call(this,p);this[$[59]]=this[$[180]].bind(this);this.source=h;this[$[125]]},function(j,k){_.get(j,"width",function(){return this[$[18]][this[$[17]]]||1});_.get(j,$[14],function(){return this[$[18]][this[$[32]]]||1});_.get(j,"renderSource",function(){return this[$[159]]});_[$[1]](j,"source",{get:function(){return this[$[18]]},set:function(v){if(v){this._loaded=!1;this[$[18]]&&this[$[18]][$[163]](this[$[125]],this[$[59]]);this[$[18]]=v;this.isVideo=this._getSourceType()==="video";this[$[125]]=this.isVideo?"canplay":"load";this[$[128]]();this[$[18]][$[87]](this[$[125]],this[$[59]])}}});j[$[45]]=function(b){AGL.Utils[$[85]](this.gl,this,b)};j[$[26]]=function(c,n){return k[$[26]].call(this,c,n)||(this.isVideo&&!this[$[18]].paused)};j[$[8]]=function(){this[$[18]]&&this[$[18]][$[163]](this[$[125]],this[$[59]]);k[$[8]].call(this)};j[$[128]]=function(){this[$[17]]="naturalWidth";this[$[32]]="naturalHeight";if(!this[$[18]][this[$[17]]]){this[$[17]]="videoWidth";this[$[32]]="videoHeight"};if(!this[$[18]][this[$[17]]]){this[$[17]]="width";this[$[32]]=$[14]};this._loaded=this[$[18]][this[$[17]]]>0&&this[$[18]][this[$[32]]]>0;if(this._loaded){this[$[159]]=this[$[18]];++this[$[67]]}else this[$[159]]=$n};j._getSourceType=function(){return this[$[18]].tagName?this[$[18]].tagName.toLowerCase():""};j[$[180]]=j[$[128]]});AGL.Texture.loadImage=function(d,p){var f=$d[$[162]]("img");var m=new AGL.Texture(f,p);f.src=d;return m};AGL.Texture.loadVideo=function(d,p){var g=$d[$[162]]("video");var m=new AGL.Texture(g,p);g.src=d;return m};AGL.Framebuffer=_[$[0]](AGL[$[103]],function j(k){AGL[$[103]].call(this,k);this[$[113]]=AGL.Utils.info[$[38]]-1},function(d,f){_[$[1]](d,"width",{get:function(){return this[$[9]]},set:function(v){if(this[$[9]]!==v&&v>0){this[$[9]]=v;++this[$[67]]}}});_[$[1]](d,$[14],{get:function(){return this[$[7]]},set:function(v){if(this[$[7]]!==v&&v>0){this[$[7]]=v;++this[$[67]]}}});d.setSize=function(w,h){this.width=w;this[$[14]]=h};d[$[8]]=function(){this[$[106]]();f[$[8]].call(this)};d[$[45]]=function(b){AGL.Utils[$[173]](this.gl,this,b)};d[$[26]]=function(c,g){if(this.gl!==c){this[$[101]]();this[$[81]]=c.createTexture();AGL.Utils[$[85]](c,this,this[$[113]]);this[$[106]]();this[$[142]]=c.createFramebuffer();c[$[100]](36160,this[$[142]]);c.framebufferTexture2D(36160,36064,3553,this[$[81]],0);this.gl=c;this._loaded=!0;return!0};if(this[$[167]]&&this[$[16]]<g){this[$[16]]=g;return!0};if(this[$[19]]<this[$[67]]){this[$[19]]=this[$[67]];AGL.Utils[$[85]](c,this,this[$[113]]);return!0};return!1};d[$[106]]=function(){AGL.Utils[$[170]](this.gl,this[$[142]])}});AGL.Matrix3={identity:function(){return new F32A([1,0,0,1,0,0])},projection:function(c,h,z){z[0]=2/c;z[1]=z[2]=0;z[3]=-2/h;z[4]=-1;z[5]=1},transformLocal:function(d,z){var j=d.anchorX;var k=d.anchorY;var q=d[$[77]];var w=d[$[69]];z[0]=d[$[97]]*q;z[1]=d[$[99]]*q;z[2]=-d[$[95]]*w;z[3]=d[$[98]]*w;z[4]=d.x-j*z[0]-k*z[2];z[5]=d.y-j*z[1]-k*z[3]},transform:function(g,d,z){var x=d.x;var y=d.y;var j=d.anchorX;var k=d.anchorY;var r=d[$[99]];var v=d[$[95]];var t=d[$[97]];var s=d[$[98]];var q=d[$[77]];var w=d[$[69]];z[0]=(t*g[0]+r*g[2])*q;z[1]=(t*g[1]+r*g[3])*q;z[2]=(s*g[2]-v*g[0])*w;z[3]=(s*g[3]-v*g[1])*w;z[4]=-j*z[0]-k*z[2]+x*g[0]+y*g[2]+g[4];z[5]=-j*z[1]-k*z[3]+x*g[1]+y*g[3]+g[5]},inverse:function(g,z){var b=1/(g[0]*g[3]-g[2]*g[1]);z[0]=b*g[3];z[1]=-b*g[1];z[2]=-b*g[2];z[3]=b*g[0];z[4]=b*(g[2]*g[5]-g[3]*g[4]);z[5]=-b*(g[0]*g[5]-g[1]*g[4])},isPointInMatrix:function(g,f){var x=f.x*g[0]+f.y*g[2]+g[4];var y=f.x*g[1]+f.y*g[3]+g[5];return x>=0&&x<=1&&y>=0&&y<=1},calcCorners:function(g,l,p){var m=p.widthHalf;var n=p[$[154]];l[0].x=m+g[4]*m;l[0].y=p[$[14]]-(n+g[5]*n);l[1].x=l[0].x+(g[0]+g[2])*m;l[1].y=l[0].y-(g[1]+g[3])*n;l[2].x=l[0].x+(g[0]+m*g[2]);l[2].y=l[0].y-(g[1]+n*g[3]);l[3].x=l[0].x+(m*g[0]+g[2]);l[3].y=l[0].y-(n*g[1]+g[3])}};AGL.Point={create:function(x,y){return{x:x||0,y:y||0}}};AGL.Rect={create:function(x,y,b,c){return{x:x||0,y:y||0,width:b||0,height:c||0}}};AGL.BaseItem=_[$[0]](_[$[5]],function b(){_[$[5]].call(this);this[$[20]]=AGL.Matrix3.identity();this[$[118]]=this[$[24]]=0;this[$[70]]=[1,1,1,1]});AGL.Item=_[$[0]](AGL.BaseItem,function b(){AGL.BaseItem.call(this);this.TYPE=AGL.Item.TYPE;this.renderable=!0;this.props=new AGL.ItemProps();this.color=new AGL.ColorProps();this[$[90]]=this[$[31]]=this[$[27]]=this[$[28]]=this[$[10]]=0;this.callback=_[$[15]];this._bounds=AGL.Rect.create()},function(d,f){_.get(d,"stage",function(){return this[$[42]]?this[$[42]].stage:$n});_[$[1]](d,"parent",{get:function(){return this[$[42]]},set:function(v){if(this[$[42]]!==v){this[$[42]]=v;this[$[27]]=this[$[28]]=this[$[10]]=0}}});_[$[1]](d,"callback",{get:function(){return this._callback},set:function(v){if(this._callback!==v)this._callback=v||_[$[15]]}});d.getBounds=function(){return this._bounds};d[$[8]]=function(){this[$[42]]&&this[$[42]][$[104]]&&this[$[42]][$[104]](this);f[$[8]].call(this)};d.update=function(h){this[$[96]](h)};d[$[96]]=function(h){var c=this.props;c[$[149]]();c.updateScale();var g=this[$[42]];(this[$[27]]<g[$[24]]||this[$[90]]<c[$[4]])&&this[$[89]](c,g)};d[$[89]]=function(c,g){this[$[27]]=g[$[24]];this[$[90]]=c[$[4]];++this[$[24]];AGL.Matrix3.transform(g[$[20]],c,this[$[20]])}});AGL.Item.TYPE="item";AGL[$[57]]=_[$[0]](AGL.Item,function k(h){AGL.Item.call(this);this[$[107]]=new F32A(6);this._corners=[AGL.Point.create(),AGL.Point.create(),AGL.Point.create(),AGL.Point.create()]},function(f){f.getCorners=function(){this[$[30]]();return this._corners};f.getBounds=function(){this[$[30]]();return this._bounds};f[$[164]]=function(){AGL.Matrix3.calcCorners(this[$[20]],this._corners,this.stage.renderer)};f._calcBounds=function(){this[$[164]]();var j=this._corners;var g=this._bounds;var a=j[0];var b=j[1];var c=j[2];var d=j[3];g.x=Math.min(a.x,b.x,c.x,d.x);g.y=Math.min(a.y,b.y,c.y,d.y);g.width=Math.max(a.x,b.x,c.x,d.x);g[$[14]]=Math.max(a.y,b.y,c.y,d.y)};f[$[30]]=function(){if(this[$[10]]<this[$[24]]){this[$[10]]=this[$[24]];AGL.Matrix3.inverse(this[$[20]],this[$[107]]);this._calcBounds()}}});AGL.Light=_[$[0]](AGL[$[57]],function l(f,r,t){AGL[$[57]].call(this);this.color.a=0;this._id=f;this._matId=f*16;this._colId=this._matId+8;this._datId=this._matId+12;this._extId=f*4;this[$[21]]=r;this[$[13]]=t;this.angle=360*Math.PI/180;this.castShadow=!0;this.type=AGL.Light.Type.SPOT;this[$[29]]=1;this[$[148]]=1},function(n,m){_[$[1]](n,"type",{get:function(){return this[$[13]][this._extId]},set:function(v){this[$[13]][this._extId]=v}});_[$[1]](n,"castShadow",{get:function(){return this[$[13]][this._extId+1]},set:function(v){this[$[13]][this._extId+1]=v}});_[$[1]](n,$[29],{get:function(){return this[$[13]][this._extId+3]},set:function(v){this[$[13]][this._extId+3]=Math.max(1,Math.min(10,v))}});_[$[1]](n,$[148],{get:function(){return this[$[21]][this._datId+1]},set:function(v){this[$[21]][this._datId+1]=Math.max(0,v)}});_[$[1]](n,"angle",{get:function(){return this[$[21]][this._datId+3]},set:function(v){this[$[21]][this._datId+3]=v}});n.isOn=function(){return this.renderable&&this.stage!==$n};n[$[30]]=function(){if(this.isOn()&&this[$[10]]<this[$[24]]){this[$[10]]=this[$[24]];this._calcBounds()}};n[$[164]]=function(){AGL.Matrix3.calcCorners(this[$[20]],this._corners,this.stage.renderer);var q=this._corners;var a=q[0];var b=q[1];var c=q[2];var d=q[3];a.x+=(a.x-d.x)+(a.x-c.x);a.y+=(a.y-d.y)+(a.y-c.y);c.x+=(c.x-b.x);c.y+=(c.y-b.y);d.x+=(d.x-b.x);d.y+=(d.y-b.y)};n.update=function(s){var r=this[$[21]];var k=this._datId;if(this.isOn()){this[$[96]](s);this[$[133]]();r[k]=r[k-1]>0?1:0;r[k+2]=this.props.alpha;this[$[13]][this._extId+2]=this.props.z}else r[k]=0};n[$[89]]=function(j,p){m[$[89]].call(this,j,p);_[$[62]](this[$[21]],this[$[20]],this._matId)};n[$[133]]=function(){var h=this.color;if(this[$[31]]<h[$[4]]){this[$[31]]=h[$[4]];var r=this[$[21]];var w=this[$[42]][$[70]];var g=this._colId;var x=w[3]*h.a;r[g]=w[0]*h.r*x;r[g+1]=w[1]*h.g*x;r[g+2]=w[2]*h.b*x;r[g+3]=x}}});AGL.Light.Type=_[$[91]]({SPOT:0,AMBIENT:1});AGL.Image=_[$[0]](AGL[$[57]],function b(g){AGL[$[57]].call(this);this.TYPE=AGL.Image.TYPE;this[$[115]]=AGL.Matrix3.identity();this.maskType=AGL.Image.MaskType.ALPHA;this.tintType=AGL.Image.TintType.NONE;this.blendMode=AGL.BlendMode.NORMAL;this.textureProps=new AGL.TextureProps();this[$[60]]=new AGL.TextureCrop();this[$[55]]=0;this[$[176]]=this[$[60]].items;this[$[70]]=this.color.items;this[$[41]]=g},function(f){f.update=function(h){this[$[96]](h);this._updateTexture();this[$[60]].updateCrop()};f.isContainsPoint=function(c){this[$[30]]();return AGL.Matrix3.isPointInMatrix(this[$[107]],c)};f._updateTexture=function(){var d=this.textureProps;d[$[149]]();if(this[$[55]]<d[$[4]]){this[$[55]]=d[$[4]];AGL.Matrix3.transformLocal(d,this[$[115]])}}});AGL.Image.TYPE="drawable";AGL.Image.TintType=_[$[91]]({NONE:0,NORMAL:1,GRAYSCALE:2,OVERRIDE:3});AGL.Image.MaskType=_[$[91]]({RED:0,GREEN:1,BLUE:2,ALPHA:3,AVG:4});AGL.AnimatedImage=_[$[0]](AGL.Image,function j(f){AGL.Image.call(this,f);this.frameLength=120;this.frames=[];this.frame=this[$[16]]=0;this[$[66]];this.stop()},function(c,d){_.get(c,"isPlaying",function(){return this[$[66]]===this[$[137]]});c.gotoAndStop=function(b){this.stop();this.frame=b;this[$[138]]()};c.gotoAndPlay=function(b){this.frame=b;this.play()};c.stop=function(){this[$[66]]=_[$[15]]};c.play=function(){this[$[66]]=this[$[137]]};c.update=function(g){d.update.call(this,g);this[$[66]](g)};c[$[137]]=function(g){var h=g-this[$[16]];if(h>this.frameLength){this[$[16]]=g;this.frame+=~~(h/this.frameLength);this.frame>=this.frames.length&&(this.frame=0);this[$[138]]()}};c[$[138]]=function(){var k=this.frames[this.frame];this[$[60]].x=k.x;this[$[60]].y=k.y;this[$[60]].width=k.width;this[$[60]][$[14]]=k[$[14]]};c[$[8]]=function(){this.stop();d[$[8]].call(this)}});AGL[$[108]]=_[$[0]](AGL.Item,function n(){AGL.Item.call(this);this.TYPE=AGL[$[108]].TYPE;this[$[33]]=[]},function(m,g){m[$[8]]=function(){this.empty();g[$[8]].call(this)};m.empty=function(){while(this[$[33]].length)this.removeChildAt(0)};m.contains=function(b){return this[$[119]](b)>-1};m.addChild=function(b){return this.addChildAt(b,this[$[33]].length)};m.addChildAt=function(b,c){if(b){b.parent&&b.parent[$[104]](b);this[$[33]].push(b);this[$[122]](b,c);b.parent=this};return b};m[$[104]]=function(b){if(b){_[$[147]](this[$[33]],b);b.parent=$n};return b};m.removeChildAt=function(c){return this[$[104]](this.getChildAt(c))};m.getChildAt=function(c){return this[$[33]][c]};m[$[122]]=function(b,c){_[$[147]](this[$[33]],b);this[$[33]].splice(c,0,b);return b};m[$[119]]=function(b){return this[$[33]].indexOf(b)};m.swapChildren=function(h,j){var t=this[$[119]](h);var s=this[$[119]](j);if(t<0||s<0)return!1;this[$[122]](h,s);this[$[122]](j,t);return!0};m.getBounds=function(){var f=this._bounds;f.x=1/0;f.y=1/0;f.width=-1/0;f[$[14]]=-1/0;var l=this[$[33]].length;for(var i=0;i<l;++i){var r=this[$[33]][i].getBounds();f.x=Math.min(f.x,r.x);f.y=Math.min(f.y,r.y);f.width=Math.max(f.width,r.width);f[$[14]]=Math.max(f[$[14]],r[$[14]])};return f};m.update=function(p){this[$[96]](p);this[$[133]]()};m[$[133]]=function(){var k=this[$[42]];var d=this.color;if(this[$[28]]<k[$[118]]||this[$[31]]<d[$[4]]){this[$[31]]=d[$[4]];this[$[28]]=k[$[118]];++this[$[118]];var q=this[$[70]];var v=k[$[70]];q[0]=v[0]*d.r;q[1]=v[1]*d.g;q[2]=v[2]*d.b;q[3]=v[3]*d.a}}});AGL[$[108]].TYPE=$[161];AGL.StageContainer=_[$[0]](AGL[$[108]],function d(c){AGL[$[108]].call(this);this.renderer=c;this[$[42]]=new AGL.BaseItem()},function(b){_.get(b,"stage",function(){return this});_.get(b,"parent",function(){return this[$[42]]})});AGL.SmoothLight=_[$[0]](_[$[5]],function g(d){d=d||{};_[$[5]].call(this);this[$[61]]=new AGL[$[83]](d);this[$[143]]=new AGL.BlurFilter();this[$[72]]=new AGL[$[73]]({texture:new AGL.Texture(this[$[61]].canvas,!0),filters:[this[$[143]]]});this.image=new AGL.Image(new AGL.Texture(this[$[72]].canvas,!0));this.image.blendMode=AGL.BlendMode.MULTIPLY;this.scale=d.scale||1;this.blur=_.isEmpty(d.blur)?1:d.blur},function(b,c){_[$[1]](b,"scale",{get:function(){return this._scale},set:function(v){if(this._scale!==v){this._scale=v;this[$[36]]=this[$[54]]}}});_[$[1]](b,"blur",{get:function(){return this._blur},set:function(v){if(this._blur!==v){this._blur=v;var f=this[$[143]];f.intensityX=f[$[151]]=this._blur}}});_.get(b,$[56],function(){return this[$[61]][$[56]]});b.render=function(){this[$[36]]();this[$[61]].render();this[$[72]].render()};b.setSize=function(w,h){this[$[9]]=w;this[$[7]]=h;this[$[36]]=this[$[54]]};b[$[8]]=function(){this[$[61]][$[8]]();this[$[72]][$[8]]();this[$[143]][$[8]]();this.image[$[8]]();c[$[8]].call(this)};b[$[54]]=function(){this[$[36]]=_[$[15]];var j=this[$[9]]*this._scale;var k=this[$[7]]*this._scale;this.image.props.width=this[$[9]];this.image.props[$[14]]=this[$[7]];this[$[61]].setSize(j,k);this[$[72]].setSize(j,k)}});AGL[$[51]]=_[$[0]](_[$[5]],function z(q){_[$[5]].call(this);this[$[46]]=new AGL.ColorProps();this.width=this[$[14]]=1;this.widthHalf=this[$[154]]=this[$[35]]=this[$[63]]=0;this[$[36]]=this[$[54]];this[$[76]]=q;this._canvas=q.canvas;this._init()},function(s){_.get(s,"canvas",function(){return this._canvas});_.get(s,$[56],function(){return this._context&&this._context[$[56]]&&this._context[$[56]]()});_.get(s,"context",function(){if(!this._context||this[$[56]])this._context=this._canvas.getContext("webgl2",this[$[76]][$[175]]);return this._context});_[$[1]](s,"width",{get:function(){return this[$[9]]},set:function(v){if(this[$[9]]!==v){this[$[9]]=v;this[$[36]]=this[$[54]]}}});_[$[1]](s,$[14],{get:function(){return this[$[7]]},set:function(v){if(this[$[7]]!==v){this[$[7]]=v;this[$[36]]=this[$[54]]}}});s.clear=function(){var B=this[$[46]];if(this[$[63]]<B[$[4]]){this._gl[$[94]](this[$[44]]);this[$[63]]=B[$[4]];this._gl[$[46]](this[$[46]].r,this[$[46]].g,this[$[46]].b,this[$[46]].a)};this._gl.clear(16384)};s.setSize=function(k,r){this.width=k;this[$[14]]=r};s.renderToTexture=function(y){this._gl[$[94]](this[$[44]]);this[$[71]](y);this[$[134]](y);AGL.Utils[$[78]](this._gl)};s.render=function(y){this._gl[$[94]](this[$[44]]);this._gl.uniform1f(this[$[6]].uFlpY,1);this[$[134]]()};s[$[134]]=function(y){this[$[35]]=Date.now();this[$[36]]();this[$[121]](AGL.BlendMode.NORMAL);this._render(y)};s[$[71]]=function(y){y.setSize(this.width,this[$[14]]);y[$[26]](this._gl,this[$[35]]);AGL.Utils.bindFrameBuffer(this._gl,y);this._gl.uniform1f(this[$[6]].uFlpY,-1)};s[$[121]]=function(w){this[$[130]]=w;var d=w.eqs;var j=w.funcs;this._gl[w.eqName](d[0],d[1]);this._gl[w.funcName](j[0],j[1],j[2],j[3])};s[$[54]]=function(){this[$[36]]=_[$[15]];this.widthHalf=this[$[9]]*.5;this[$[154]]=this[$[7]]*.5;this._setCanvasSize(this[$[9]],this[$[7]])};s._setCanvasSize=function(k,r){this._canvas.width=k;this._canvas[$[14]]=r;this._gl.viewport(0,0,k,r)};s[$[8]]=function(){this[$[179]]();this[$[46]]=this._gl=this[$[84]]=this[$[64]]=this[$[44]]=this[$[6]]=this[$[76]]=this._canvas=this._context=this[$[130]]=$n};s[$[179]]=function(){this._gl[$[94]]($n);this._gl.detachShader(this[$[44]],this[$[84]]);this._gl[$[165]](this[$[84]]);this._gl.detachShader(this[$[44]],this[$[64]]);this._gl[$[165]](this[$[64]]);this._gl.deleteProgram(this[$[44]]);this[$[140]]&&this[$[140]].loseContext()};s[$[11]]=function(h,x,p,b,g,f,l){var m=this._gl[$[132]]();this._gl[$[123]](34962,m);this._gl[$[153]](34962,h.byteLength,35048);this[$[172]](this[$[6]][x],m,h,p,b,g,f,l);return m};s[$[172]]=function(t,m,h,p,b,g,f,l){this[$[12]](m,h);var n=l*p;var i=b+1;while(--i){var c=t+(b-i);this._gl[$[141]](c);this._gl["vertexAttrib"+(f===5126?"":"I")+"Pointer"](c,g,f,!1,n,(b-i)*l*g);this._gl.vertexAttribDivisor(c,1)}};s[$[12]]=function(m,h){this._gl[$[123]](34962,m);this._gl.bufferSubData(34962,0,h)};s._init=function(){this._gl=this.context;this[$[140]]=this._gl.getExtension('WEBGL_lose_context');this._gl.pixelStorei(37441,!0);this._gl.enable(3042);this[$[84]]=AGL.Utils[$[136]](this._gl,this[$[76]].vertexShader(this[$[76]]));this[$[64]]=AGL.Utils[$[117]](this._gl,this[$[76]].fragmentShader(this[$[76]]));this[$[44]]=AGL.Utils[$[157]](this._gl,[this[$[84]],this[$[64]]]);this[$[6]]=AGL.Utils.getLocationsFor(this._gl,this[$[44]],this[$[76]][$[43]]);this._gl[$[94]](this[$[44]]);var A=this._gl[$[132]]();this._gl[$[123]](34962,A);this._gl[$[153]](34962,new F32A([0,0,1,0,1,1,0,1]),35044);this._gl.vertexAttribPointer(this[$[6]].aPos,2,5126,!1,0,0);this._gl[$[141]](this[$[6]].aPos);this[$[48]]()}});AGL[$[53]]=_[$[0]](AGL[$[51]],function r(h){h.config[$[43]]=h.config[$[43]].concat(["aMt"]);this._container=new AGL.StageContainer(this);this[$[52]]=Math.max(1,h.maxBatchItems||1e4);this[$[50]]=_[$[15]];this[$[22]]=0;this._TEXTURE_NUM=AGL.Utils.info[$[38]];this[$[80]]=[];AGL[$[51]].call(this,h.config);this[$[58]]={};this[$[58]][AGL.Item.TYPE]=_[$[15]];this[$[58]][AGL.Image.TYPE]=this._drawImage.bind(this);this[$[58]][AGL[$[108]].TYPE]=this._drawContainer.bind(this)},function(d,f){_.get(d,$[161],function(){return this._container});_[$[1]](d,"clearBeforeRender",{get:function(){return this[$[50]]===this.clear},set:function(v){this[$[50]]=v?this.clear:_[$[15]]}});d._render=function(){this[$[50]]();this._drawItem(this._container);this[$[93]]()};d._drawItem=function(b){b.update(this[$[35]]);b.callback(b,this[$[35]]);b.renderable&&this[$[58]][b.TYPE](b)};d._drawContainer=function(m){var j=m[$[33]];var l=j.length;for(var i=0;i<l;++i)this._drawItem(j[i])};d[$[39]]=function(b,q){var c=this[$[22]]*16;_[$[62]](this[$[79]],b[$[20]],c);_[$[62]](this[$[79]],b[$[115]],c+6);_[$[62]](this[$[79]],b[$[176]],c+12)};d._drawImage=function(b){this[$[160]](b.blendMode);var q=this[$[135]](b[$[41]],!1);this[$[39]](b,q);++this[$[22]]===this[$[52]]&&this[$[93]]()};d[$[68]]=function(){this[$[12]](this._matrixBuffer,this[$[79]])};d[$[93]]=function(){if(this[$[22]]>0){this[$[68]]();this._gl.uniform1iv(this[$[6]].uTex,this[$[144]]);this._gl[$[152]](6,6,5123,0,this[$[22]]);this[$[22]]=0;this._gl.flush()}};d[$[135]]=function(n,g){if(n){var p=this[$[80]].indexOf(n);var s=p<0;if(n[$[26]](this._gl,this[$[35]])||s){if(s){if(this[$[80]].length===this._TEXTURE_NUM-g){this[$[93]]();this[$[80]].length=this[$[144]].length=0};this[$[80]].push(n);p=this[$[80]].length-1;this[$[144]][p]=p};n[$[45]](p)};return p};return-1};d[$[160]]=function(k){if(this[$[130]]!==k){this[$[93]]();this[$[121]](k)}};d[$[54]]=function(){f[$[54]].call(this);AGL.Matrix3.projection(this[$[9]],this[$[7]],this[$[161]].parent[$[20]]);++this[$[161]].parent[$[24]]};d[$[48]]=function(){this._gl[$[123]](34963,this._gl[$[132]]());this._gl[$[153]](34963,AGL.Utils.pointsOrder,35044);this[$[144]]=[];this[$[79]]=new F32A(this[$[52]]*16);this._matrixBuffer=this[$[11]](this[$[79]],"aMt",16,4,4,5126,4)}});AGL[$[73]]=_[$[0]](AGL[$[51]],function n(j){j=j||{};j.config=AGL.Utils[$[124]](j.config,AGL[$[73]]);j.config[$[43]]=j.config[$[43]].concat(["uFTex","uFtrT","uFtrST","uFtrV","uFtrK"]);this.filters=j.filters||[];AGL[$[51]].call(this,j.config);this[$[41]]=j[$[41]]},function(c,d){c.renderToTexture=function(m){this._gl[$[94]](this[$[44]]);this[$[134]](m)};c._render=function(m){this._gl.uniform1i(this[$[6]].uTex,0);this._gl.uniform1f(this[$[6]].uFlpY,1);this[$[41]][$[26]](this._gl,this[$[35]])&&this[$[41]][$[45]](0);this.clear();var l=this.filters.length||1;var b=l-2;for(var i=0;i<l;++i){var f=this.filters[i];var k=f&&f.on;var p=$n;var g=i>b;if(k&&f[$[41]]&&(f[$[41]][$[26]](this._gl,this[$[35]])||this[$[155]]!==f[$[41]])){this[$[155]]=f[$[41]];this._gl.uniform1i(this[$[6]].uFTex,1);f[$[41]][$[45]](1)};if(g){if(m){this[$[71]](m)}else{AGL.Utils[$[78]](this._gl);this._gl.uniform1f(this[$[6]].uFlpY,1)}}else if(k){p=this[$[120]][i&1];this[$[71]](p)};if(k){this._gl.uniform1fv(this[$[6]].uFtrV,f.v);this._gl.uniform1fv(this[$[6]].uFtrK,f.kernels);this._gl.uniform1i(this[$[6]].uFtrT,f.TYPE);this._gl.uniform1i(this[$[6]].uFtrST,f.SUB_TYPE)};(k||g)&&this._gl.drawArrays(6,0,4);p&&p[$[45]](0)};m&&AGL.Utils[$[78]](this._gl);this._gl.flush()};c[$[8]]=function(){this[$[120]][0][$[8]]();this[$[120]][1][$[8]]();d[$[8]].call(this)};c[$[48]]=function(){this[$[120]]=[new AGL.Framebuffer(),new AGL.Framebuffer()]}});AGL[$[73]][$[49]]=function(h){return AGL.Utils[$[23]](h[$[29]])+"in vec2 aPos;uniform float uFlpY;out vec2 vCrd;out vec2 vTCrd;void main(void){vec3 pos=vec3(aPos*2.-1.,1);gl_Position=vec4(pos,1);gl_Position.y*=uFlpY;vCrd=pos.xy;vTCrd=(pos.xy+vec2(1,-1))/vec2(2,-2);}"};AGL[$[73]][$[37]]=function(h){return AGL.Utils[$[23]](h[$[29]])+"uniform sampler2D uTex;uniform sampler2D uFTex;uniform int uFtrT;uniform int uFtrST;uniform float uFtrV[9];uniform float uFtrK[9];in vec2 vCrd;in vec2 vTCrd;out vec4 fgCol;void main(void){fgCol=texture(uTex,vTCrd);if(uFtrT>0){float[] fvl=uFtrV;float[] fkr=uFtrK;vec2 oPx=1./vec2(textureSize(uTex,0));vec2 vol=fvl[0]*oPx;if(uFtrT<2)fgCol=fvl[0]*(texture(uTex,vTCrd-oPx)*fkr[0]+texture(uTex,vTCrd+oPx*vec2(0,-1))*fkr[1]+texture(uTex,vTCrd+oPx*vec2(1,-1))*fkr[2]+texture(uTex,vTCrd+oPx*vec2(-1,0))*fkr[3]+fgCol*fkr[4]+texture(uTex,vTCrd+oPx*vec2(1,0))*fkr[5]+texture(uTex,vTCrd+oPx*vec2(-1,1))*fkr[6]+texture(uTex,vTCrd+oPx*vec2(0,1))*fkr[7]+texture(uTex,vTCrd+oPx)*fkr[8])/9.;else if(uFtrT<3){if(uFtrST<2)fgCol=vec4(vec3((fgCol.r+fgCol.g+fgCol.b)/3.),fgCol.a);else if(uFtrST<3)fgCol=vec4(vec3(.874,.514,.156)*((fgCol.r+fgCol.g+fgCol.b)/3.),fgCol.a);else if(uFtrST<4)fgCol=abs(vec4(fgCol.rgb-1.,fgCol.a));else if(uFtrST<5)fgCol=vec4((fgCol.rgb*(1.-fvl[0]))+(vec3(fvl[2],fvl[3],fvl[4])*fvl[0]),fgCol.a);else if(uFtrST<6)fgCol=vec4((round((fgCol.rgb*256.)/fvl[0])/256.)*fvl[0],fgCol.a);else if(uFtrST<7){vec2 pv=pow(abs(vCrd*fvl[0]),vec2(fvl[1]));float v=clamp(min(1.,(1.-length(pv))*fvl[5]),0.,1.);fgCol*=vec4(vec3(v),fgCol.a);fgCol+=vec4(vec3(fvl[2],fvl[3],fvl[4])*(1.-v),0);}else if(uFtrST<8)fgCol+=vec4(vCrd.xy*.15,(vCrd.x-vCrd.y)*.15,0);else if(uFtrST<9)fgCol=vec4((fgCol.rgb-.5)*fvl[1]+.5+fvl[0],fgCol.a);else if(uFtrST<10)fgCol=vec4(pow(fgCol.rgb,vec3(fvl[0])),fgCol.a);}else if(uFtrT<4){vec2 wh=oPx*vec2(fvl[0],fvl[1]);vec4 col=vec4(0);float c=0.;float m;float im;vec4 tCol;if(uFtrST<2)for(float i=-2.;i<3.;++i){for(float j=-2.;j<3.;++j){m=abs(i)+abs(j);im=1.-(m*.25);tCol=i==0.&&j==0.?fgCol:texture(uTex,vTCrd+(wh*vec2(i,j)));col+=tCol*im;c+=im;}}else{float oAvg=uFtrST==2?(fgCol.r+fgCol.g+fgCol.b+fgCol.a)/4.:0.;for(float i=-2.;i<3.;++i){for(float j=-2.;j<3.;++j){m=abs(i)+abs(j);im=1.-(m*.25);tCol=i==0.&&j==0.?fgCol:texture(uTex,vTCrd+(wh*vec2(i,j)));float avg=(tCol.r+tCol.g+tCol.b+tCol.a)/4.;if(avg-oAvg>=fvl[3]*m){col+=tCol*im*(2.-fvl[3]);c+=im;}}}}fgCol=col/c;}else if(uFtrT<5)fgCol=texture(uTex,floor(vTCrd/vol)*vol);else if(uFtrT<6){vec2 flp=vec2(1,-1);vec2 dspMd=flp*(texture(uFTex,mod(flp*(vCrd*.5+.5)+vec2(fvl[1],fvl[2]),1.)).rg-.5)*2.*vol;fgCol=texture(uTex,vTCrd+dspMd);}}}"};AGL[$[83]]=_[$[0]](AGL[$[51]],function t(l){l=l||{};var g=AGL.Utils[$[124]]({canvas:l.canvas,isOffscreen:!0,locations:["aMt","aExt","uHTex","uDHS","uDHL","uAT","uS","uTE"]},AGL[$[83]]);g.lightNum=Math.max(0,l.lightNum||1);AGL[$[51]].call(this,g);this.shadowMap=l.shadowMap;this.heightMap=l.heightMap;this[$[139]]=_.isEmpty(l[$[139]])?0:l[$[139]];this[$[131]]=_.isEmpty(l[$[131]])?1:l[$[131]];this[$[126]]=l[$[126]]===!0},function(h,j){_[$[1]](h,$[139],{get:function(){return this[$[168]]},set:function(v){this[$[168]]=Math.max(0,Math.min(1,v||0))}});_[$[1]](h,$[131],{get:function(){return this[$[158]]},set:function(v){this[$[158]]=Math.max(0,Math.min(1,v||1))}});_[$[1]](h,$[126],{get:function(){return this[$[116]]},set:function(v){this[$[116]]=v?1:0}});h[$[129]]=function(k,s,b,p){if(k){this._gl.uniform1i(this[$[6]][s],++p);k[$[26]](this._gl,this[$[35]])&&k[$[45]](p);this[$[86]][b]=1}else this[$[86]][b]=0;return p};h._render=function(){var p=-1;p=this[$[129]](this.shadowMap,"uTex",0,p);p=this[$[129]](this.heightMap,"uHTex",1,p);this._gl.uniform2fv(this[$[6]].uTE,this[$[86]]);this._gl.uniform1f(this[$[6]].uDHS,this[$[168]]);this._gl.uniform1f(this[$[6]].uDHL,this[$[158]]);this._gl.uniform1f(this[$[6]].uAT,this[$[116]]);this[$[12]](this._lightBuffer,this[$[21]]);this[$[12]](this[$[181]],this[$[13]]);this._gl[$[46]](0,0,0,1);this._gl.clear(16384);this[$[121]](AGL.BlendMode.ADD);this._gl[$[152]](6,6,5123,0,this._lights.length);this._gl.flush()};h.getLight=function(b){return this._lights[b]};h[$[54]]=function(){j[$[54]].call(this);this._gl.uniform4f(this[$[6]].uS,this[$[9]],this[$[7]],1/this[$[9]],1/this[$[7]])};h[$[48]]=function(){this._gl[$[123]](34963,this._gl[$[132]]());this._gl[$[153]](34963,AGL.Utils.pointsOrder,35044);this[$[86]]=[0,0];var m=this[$[76]].lightNum;this[$[21]]=new F32A(m*16);this._lightBuffer=this[$[11]](this[$[21]],"aMt",16,4,4,5126,4);this[$[13]]=new F32A(m*4);this[$[181]]=this[$[11]](this[$[13]],"aExt",4,1,4,5126,4);this._lights=[];for(var i=0;i<m;++i)this._lights.push(new AGL.Light(i,this[$[21]],this[$[13]]))}});AGL[$[83]][$[49]]=function(g){return AGL.Utils[$[23]](g[$[29]])+"#define H vec4(1,-1,2,-2)\nin vec2 aPos;in mat4 aMt;in vec4 aExt;uniform vec4 uS;uniform float uFlpY;out vec2 vTCrd;out vec4 vCrd;out vec4 vCol;out vec4 vDat;out vec4 vExt;out mat4 vQ;out vec4 vS;out float vHS;void main(void){vec3 pos=vec3(aPos*2.-1.,1);vExt=aExt;vCol=aMt[2];vDat=aMt[3];vCrd.xy=pos.xy;vS=uS;vHS=clamp(.01,1.,vExt.z/1024.);if(vExt.x<1.){mat3 mt=mat3(aMt[0].xy,0,aMt[0].zw,0,aMt[1].xy,1);gl_Position=vec4(mt*pos,1);vTCrd=(gl_Position.xy+H.xy)/H.zw;vCrd.zw=((mt*vec3(0,0,1)).xy+H.xy)/H.zw;}else{mat3 mt=mat3(aMt[0].xy,0,aMt[0].zw,0,-1,1,1);gl_Position=vec4(pos,1);vTCrd=(gl_Position.xy+H.xy)/H.zw;vCrd.zw=vTCrd+((mt*vec3(1,1,1)).xy+H.xy)/H.zw;}gl_Position.y*=uFlpY;}"};AGL[$[83]][$[37]]=function(g){var n="vec2 p=vTCrd-i*m;";var q="float pc=(i/dstTex)*mh;";var w="tc=texture(uTex,p);if(c.a<tc.a){c.a+=tc.a;if(c.a>=1.)discard;}c.rgb+=rgb*tc.rgb*tc.a;";function r(c){return"float st=vExt.w;float l=dstTex-vExt.w;float umb=vDat.y;for(float i=st;i<l;++i){"+c+"i+=st+(i/dstTex)*umb;}"};function x(f,d){return"if(sl.y-sl.x<1.){if(texture(uTex,vTCrd).a>0.){ph=sl.y;mh-=ph;sl-=ph;}dst=isl?distance(vec3(0,0,vHS),vec3(vCrd.xy,ph)):distance(vec3(vTCrd,vHS),vec3(vCrd.zw,ph));"+f+"}else{"+d+"}"};return AGL.Utils[$[23]](g[$[29]])+"#define PI radians(180.)\nin vec2 vTCrd;in vec4 vCrd;in vec4 vCol;in vec4 vDat;in vec4 vExt;in vec4 vS;in float vHS;uniform sampler2D uTex;uniform sampler2D uHTex;uniform float uDHS;uniform float uDHL;uniform float uAT;uniform vec2 uTE;out vec4 fgCol;void main(void){if(vDat.x==0.)discard;bool isl=vExt.x<1.;float dst=1.;if(isl){dst=length(vCrd.xy);if(dst>1.||atan(vCrd.y,vCrd.x)+PI>vDat.w)discard;}vec3 rgb=vCol.rgb;if(vExt.y>0.&&(uTE.x>0.||uTE.y>0.)){vec2 tCrd=vTCrd*vS.xy;vec2 tCnt=vCrd.zw*vS.xy;vec2 dsth=tCrd-tCnt;float dstTex=distance(tCrd,tCnt);vec2 m=(dsth/dstTex)*vS.zw;vec4 c=vec4(0);vec4 tc;float mh=vHS;float ph=0.;if(uTE.y>0.){tc=texture(uHTex,vTCrd);ph=tc.b>0.?tc.g:0.;mh-=ph;dst=isl?distance(vec3(0,0,vHS),vec3(vCrd.xy,ph)):distance(vec3(vTCrd,vHS),vec3(vCrd.zw,ph));if(uAT>0.&&uTE.x>0.){"+r(n+"tc=texture(uHTex,p);if(tc.b>0.){tc.rg-=ph;"+q+"if(tc.x<=pc&&tc.y>=pc){"+w+"}}")+"}else{"+r(n+"tc=texture(uHTex,p);if(tc.b>0.){tc.rg-=ph;"+q+"if(tc.x<=pc&&tc.y>=pc)discard;}")+"}}else{vec2 sl=vec2(uDHS,uDHL);if(uAT>0.){"+x(r(q+"if(sl.x<=pc&&sl.y>=pc){"+n+w+"}"),r(n+w))+"}else{"+x(r(n+"if(texture(uTex,p).a>0.){"+q+"if(sl.x<=pc&&sl.y>=pc)discard;}"),r(n+"if(texture(uTex,p).a>0.)discard;"))+"}}rgb=rgb*(1.-c.a)+c.rgb;}float mp=clamp(1.-dst,0.,100.);fgCol=vec4(rgb*mp*vDat.z,1);}"};AGL[$[110]]=_[$[0]](AGL[$[53]],function h(g){g=g||{};g.config=AGL.Utils[$[124]](g.config,AGL[$[110]]);g.config[$[43]]=g.config[$[43]].concat(["aTexId"]);AGL[$[53]].call(this,g)},function(c,d){c[$[39]]=function(b,j){d[$[39]].call(this,b,j);this[$[111]][this[$[22]]]=j};c[$[68]]=function(){d[$[68]].call(this);this[$[12]](this[$[177]],this[$[111]])};c[$[48]]=function(){d[$[48]].call(this);this[$[111]]=new F32A(this[$[52]]);this[$[177]]=this[$[11]](this[$[111]],"aTexId",1,1,1,5126,4)}});AGL[$[110]][$[49]]=function(f){return AGL.Utils[$[23]](f[$[29]])+"in vec2 aPos;in mat4 aMt;in float aTexId;uniform float uFlpY;out vec2 vTCrd;out vec4 vTexCrop;out float vTexId;void main(void){"+AGL.Utils[$[146]]+"vTexId=aTexId;}"};AGL[$[110]][$[37]]=function(f){var k=AGL.Utils.info[$[38]];return AGL.Utils[$[23]](f[$[29]])+"in vec2 vTCrd;in vec4 vTexCrop;in float vTexId;uniform sampler2D uTex["+k+"];out vec4 fgCol;"+AGL.Utils[$[74]](k)+"void main(void){"+AGL.Utils.getTexColor+"}"};AGL.Stage2D=_[$[0]](AGL[$[53]],function l(m){m=m||{};m.config=AGL.Utils[$[124]](m.config,AGL.Stage2D);var n=["aWrlCol","aTintCol","aAlpCol","aFx","aMsk"];m.config[$[43]]=m.config[$[43]].concat(n);AGL[$[53]].call(this,m);this[$[145]]=AGL.Point.create()},function(g,h){g.render=function(){this.picked=$n;h.render.call(this);this[$[166]]=!1};g.setPickerPoint=function(d){this[$[166]]=!0;this[$[145]].x=(d.x-this.widthHalf)*this[$[20]][0];this[$[145]].y=(d.y-this[$[154]])*this[$[20]][4]};g._setMaskData=function(c){var b=this[$[22]]*2;if(c.mask){this[$[109]][b]=this[$[135]](c.mask,!0);this[$[109]][b+1]=c.maskType}else this[$[109]][b]=-1};g[$[39]]=function(c,q){h[$[39]].call(this,c,q);var j=this[$[22]]*4;var f=this[$[22]]*2;_[$[62]](this[$[88]],c.parent[$[70]],j);_[$[62]](this[$[112]],c[$[70]],j);this[$[127]][f]=c.props.alpha;this[$[127]][f+1]=c.parent.props.alpha;this[$[102]][f]=q;this[$[102]][f+1]=c.tintType};g._drawImage=function(c){this[$[160]](c.blendMode);if(this[$[166]]&&c.interactive&&c.isContainsPoint(this[$[145]]))this.picked=c;this._setMaskData(c);var q=this[$[135]](c[$[41]],!1);this[$[39]](c,q);++this[$[22]]===this[$[52]]&&this[$[93]]()};g[$[68]]=function(){h[$[68]].call(this);this[$[12]](this[$[171]],this[$[88]]);this[$[12]](this[$[178]],this[$[112]]);this[$[12]](this._alphaBuffer,this[$[127]]);this[$[12]](this._effectBuffer,this[$[102]]);this[$[12]](this._maskBuffer,this[$[109]])};g[$[48]]=function(){h[$[48]].call(this);var p=this[$[52]];this[$[88]]=new F32A(p*4);this[$[171]]=this[$[11]](this[$[88]],"aWrlCol",4,1,4,5126,4);this[$[112]]=new F32A(p*4);this[$[178]]=this[$[11]](this[$[112]],"aTintCol",4,1,4,5126,4);this[$[127]]=new F32A(p*2);this._alphaBuffer=this[$[11]](this[$[127]],"aAlpCol",2,1,2,5126,4);this[$[102]]=new F32A(p*2);this._effectBuffer=this[$[11]](this[$[102]],"aFx",2,1,2,5126,4);this[$[109]]=new F32A(p*2);this._maskBuffer=this[$[11]](this[$[109]],"aMsk",2,1,2,5126,4)}});AGL.Stage2D[$[49]]=function(k){return AGL.Utils[$[23]](k[$[29]])+"in vec2 aPos;in mat4 aMt;in vec4 aWrlCol;in vec4 aTintCol;in vec2 aAlpCol;in vec2 aMsk;in vec2 aFx;uniform float uFlpY;out vec2 vTCrd;out float vMskTexId;flat out int vMskTp;out vec2 vMskCrd;out vec4 vTexCrop;out vec4 vWrlCol;out vec4 vTintCol;out float vAlpCol;out float vTexId;out float vTintTp;out vec2 vGlPos;void main(void){"+AGL.Utils[$[146]]+"vGlPos=gl_Position.xy;vWrlCol=aWrlCol;vTintCol=vec4(aTintCol.rgb*aTintCol.a,1.-aTintCol.a);vAlpCol=aAlpCol.x*aAlpCol.y;vTexId=aFx.x;vTintTp=aFx.y;vMskTexId=aMsk.x;vMskTp=int(aMsk.y);vMskCrd=(vGlPos+vec2(1,-1))/vec2(2,-2);}"};AGL.Stage2D[$[37]]=function(k){var r=AGL.Utils.info[$[38]];return AGL.Utils[$[23]](k[$[29]])+"in float vMskTexId;flat in int vMskTp;in vec2 vMskCrd;in vec2 vTCrd;in vec4 vTexCrop;in vec4 vWrlCol;in vec4 vTintCol;in float vAlpCol;in float vTexId;in float vTintTp;in vec2 vGlPos;uniform sampler2D uTex["+r+"];out vec4 fgCol;"+AGL.Utils[$[74]](r)+"void main(void){"+AGL.Utils.getTexColor+"if(vAlpCol==0.||fgCol.a==0.)discard;float mskA=1.;if(vMskTexId>-1.){vec4 mskCol=gtTexCol(vMskTexId,vMskCrd);mskA=vMskTp<4?mskCol[vMskTp]:(mskCol.r+mskCol.g+mskCol.b+mskCol.a)/4.;}fgCol.a*=vAlpCol*mskA;if(fgCol.a==0.)discard;if(vTintTp>0.){vec3 col=vTintCol.rgb+fgCol.rgb*vTintCol.a;if(vTintTp<2.||(vTintTp<3.&&fgCol.r==fgCol.g&&fgCol.r==fgCol.b))fgCol.rgb*=col;else if(vTintTp<4.)fgCol.rgb=col;}fgCol*=vWrlCol;}"};AGL[$[2]]=_[$[0]](_[$[5]],function g(b,d,f){_[$[5]].call(this);this.TYPE=b;this.SUB_TYPE=d;this.on=!0;this.v=new F32A(9);this.kernels=new F32A(9);this.intensity=f},function(c){_[$[1]](c,"intensity",{get:function(){return this.v[0]},set:function(v){this.v[0]=v}});_[$[1]](c,"intensityX",{get:function(){return this.v[0]},set:function(v){this.v[0]=v}});_[$[1]](c,$[151],{get:function(){return this.v[1]},set:function(v){this.v[1]=v}});_[$[1]](c,"r",{get:function(){return this.v[2]},set:function(v){this.v[2]=v}});_[$[1]](c,"g",{get:function(){return this.v[3]},set:function(v){this.v[3]=v}});_[$[1]](c,"b",{get:function(){return this.v[4]},set:function(v){this.v[4]=v}})});AGL.DisplacementFilter=_[$[0]](AGL[$[2]],function f(c,d,x,y){AGL[$[2]].call(this,5,0,d);this[$[41]]=c;this.x=x;this.y=y},function(b){_[$[1]](b,"x",{get:function(){return this.v[1]},set:function(v){this.v[1]=v}});_[$[1]](b,"y",{get:function(){return this.v[2]},set:function(v){this.v[2]=v}})});AGL.PixelateFilter=_[$[0]](AGL[$[2]],function c(b){AGL[$[2]].call(this,4,0,b)});AGL.EdgeDetectFilter=_[$[0]](AGL[$[2]],function c(b){AGL[$[2]].call(this,1,0,b);_[$[62]](this.kernels,[-1,-1,-1,-1,8,-1,-1,-1,-1],0)});AGL.SharpenFilter=_[$[0]](AGL[$[2]],function c(b){AGL[$[2]].call(this,1,0,b);_[$[62]](this.kernels,[-1,-1,-1,-1,16,-1,-1,-1,-1],0)});AGL.GrayscaleFilter=_[$[0]](AGL[$[2]],function b(){AGL[$[2]].call(this,2,1)});AGL.SepiaFilter=_[$[0]](AGL[$[2]],function b(){AGL[$[2]].call(this,2,2)});AGL.InvertFilter=_[$[0]](AGL[$[2]],function b(){AGL[$[2]].call(this,2,3)});AGL.TintFilter=_[$[0]](AGL[$[2]],function d(c,r,g,b){AGL[$[2]].call(this,2,4,c);this.r=r;this.g=g;this.b=b});AGL.ColorLimitFilter=_[$[0]](AGL[$[2]],function c(b){AGL[$[2]].call(this,2,5,b)});AGL.VignetteFilter=_[$[0]](AGL[$[2]],function j(d,f,h,r,g,b){AGL[$[2]].call(this,2,6,d);this.roundness=f;this[$[148]]=h;this.r=r;this.g=g;this.b=b},function(c){_[$[1]](c,"roundness",{get:function(){return this.v[1]},set:function(v){this.v[1]=v}});_[$[1]](c,$[148],{get:function(){return 1/this.v[5]},set:function(v){this.v[5]=1/v}})});AGL.RainbowFilter=_[$[0]](AGL[$[2]],function b(){AGL[$[2]].call(this,2,7)});AGL.BrightnessContrastFilter=_[$[0]](AGL[$[2]],function f(d,c){AGL[$[2]].call(this,2,8,d);this.contrast=c},function(b){_[$[1]](b,"brightness",{get:function(){return this.v[0]},set:function(v){this.v[0]=v}});_[$[1]](b,"contrast",{get:function(){return this.v[1]},set:function(v){this.v[1]=v}})});AGL.GammaFilter=_[$[0]](AGL[$[2]],function c(b){AGL[$[2]].call(this,2,9,b)});AGL.BlurFilter=_[$[0]](AGL[$[2]],function b(c,d){AGL[$[2]].call(this,3,1,c);this[$[151]]=d});AGL.GlowFilter=_[$[0]](AGL[$[2]],function d(f,g,b){AGL[$[2]].call(this,3,2,f);this[$[151]]=g;this.volume=b},function(c){_[$[1]](c,"volume",{get:function(){return this.v[3]},set:function(v){this.v[3]=v}})});}).call({});