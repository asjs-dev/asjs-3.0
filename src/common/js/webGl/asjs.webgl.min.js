(function(){var $="createPrototypeClass,property,BaseFilter,createBlendMode,BasePrototypeClass,updateId,_height,_width,destruct,_currentAdditionalPropsUpdateId,height,_context,lightRenderer,emptyFunction,_source,_uploadBuffers,_currentUpdateId,matrixCache,propsUpdateId,_locations,filterRenderer,_createBuffers,locations,_scaleUpdateId,_MAX_BATCH_ITEMS,_clearBeforeRenderFunc,_currentRenderTime,_emptyTextureSlots,_currentParentColorUpdateId,_currentParentPropsUpdateId,_updateAdditionalData,_currentColorUpdateId,_rotationUpdateId,children,_dataBuffer,_extensionData,_enableBuffers,BasePositioningProps,_parent,arraySet,clearColor,createVersion,_matrixBuffer,_batchItems,_renderTime,precision,_distortionBuffer,_lightData,_canvas,_createFragmentShader,_currentTexturePropsUpdateId,_currenActivetId,_drawFunctionMap,addEventListener,isContextLost,activeTexture,_onTextureLoadedBind,_loseContextExt,renderToFramebuffer,_updateId,updateAnimation,_createVertexShader,removeEventListener,_rotation,texture,_baseTexture,colorCache,initRendererConfig,_attachFramebuffer,_currentRotationUpdateId,_onContextRestoredBound,_currentAglId,BaseProps,BatchRenderer,texParameteri,_switchToProgram,_updateTransform,_extensionBuffer,useActiveTexture,deepFreeze,useTexture,scaledHeight,_currentPropsUpdateId,_currentScaleUpdateId,sinRotationB,sinRotationA,useTextureAt,BaseDrawable,cosRotationA,_framebuffer,cosRotationB,_updateProps,BaseRenderer,maxTextureImageUnits,scaledWidth,_resizeId,_inverseMatrixCache,_elementArrayBuffer,_onContextLostBound,_textureMap,Container,_drawInstanced,Framebuffer,removeChild,TextureInfo,textureMatrixCache,_updateShadowProps,destructObjectFlat,_filterFramebuffer,colorUpdateId,createElement,_customResize,_framebuffers,clearTextures,setChildIndex,getChildIndex,_eventType,textureIds,clearBeforeRender,useProgram,_container,_renderFilterToFramebuffer,_parseTextureSize,deactivateTexture,_renderFilterFunc,_currentContextId,setBlendMode,renderSource,_renderBatch,_updateColor,_updateAnimation,_getSourceHeight,_useTextureFrame,_currentResizeId,textureRepeatRandomCache,textureCrop,bindTexture,_blurFilter,_resizeFunc,_getSourceWidth,pickerPoint,removeFromArray,_batchDrawBound,_positionBuffer,_castShadow,updateRotation,intensityY,hasOwnProperty,FilterRenderer,_batchDraw,_minFilter,webglcontextrestored,createProgram,LightRenderer,_restoreContextBound,distortionPropsCache,_isPickerSet,_calcCorners,_initContext,textureProps,loadFragmentShader,webglcontextlost,contextAttributes,readystatechange,initContextConfig,bindActiveTexture,_currentBlendMode,useRepeatTextures,_onTextureLoaded,_MAX_TEXTURE_NUM,loadVertexShader,textureCropCache,_minMipmapFilter,minMipmapFilter".split(",");var $n=null,$u=undefined,$c=console,$w=window,$d=document,$o=Object;"use strict";var helpers={};var _=helpers;_[$[141]]=function(c,b){var d=c.indexOf(b);d>-1&&c.splice(d,1)};_[$[39]]=function(c,d,b){var i=d.length;while(--i>-1)c[b+i]=d[i]};_[$[1]]=function(d,b,f){f.enumerable=!0;f.configurable=!0;$o.defineProperty(d,b,f)};_.get=function(d,b,c){_[$[1]](d,b,{get:c})};_.set=function(d,b,c){_[$[1]](d,b,{set:c})};_.isEmpty=function(b){try{return b===$u||b===$n||b===""||b.length===0}catch(e){return!0}};_.map=function(d,f){for(var b in d){if(!d[$[147]](b))continue;var c=f(b,d[b]);if(!_.isEmpty(c))d[b]=c}};_[$[13]]=function(){};_[$[0]]=function(c,g,b){var d=c.prototype;var f=g.prototype;$o.setPrototypeOf(g,c);$o.setPrototypeOf(f,d);b&&b.call(f,f,d);return g};_.iterateOver=function(h,j,k){if(_.isEmpty(h))return c();var d=$o.keys(h);var b;var i=-1;function c(){k&&k()};function f(){i++;if(i===d.length){c();return};b=d[i];if(h[$[147]]&&!h[$[147]](b))f();var g;try{g=h[b]}catch(e){};var v=j(b,g,f,c);if(!_.isEmpty(v))h[b]=v};f()};_.deleteProperty=function(c,b){var d=$o.getOwnPropertyDescriptor(c,b);if(d&&(d.get||d.set))_[$[1]](c,b,{set:_[$[13]],get:_[$[13]]});try{c[b]=$n}catch(e){};delete c[b]};_.typeIs=function(c,b){return typeof c===b};_[$[107]]=function(f){_.iterateOver(f,function(b,c,d){_.deleteProperty(f,b);d()});f=$n};_[$[4]]=_[$[0]]($o,function d(){},function(c,b){c[$[8]]=function(){_[$[107]](this);_[$[107]](b);this[$[8]]=$n};c.toObject=function(){return JSON.parse(JSON.stringify(this))}});_[$[79]]=function(b){var f=$o.getOwnPropertyNames(b);for(var c of f){var d=b[c];d&&_.typeIs(d,"object")&&_[$[79]](d)};return $o.freeze(b)};$c.log("AGL 2.0 210809175702");var F32A=Float32Array;$w.AGL={};AGL.Utils=new(_[$[0]](_[$[4]],function f(){_[$[4]].call(this);this.THETA=Math.PI/180;this[$[170]]=this.loadShader.bind(this,35633);this[$[160]]=this.loadShader.bind(this,35632);this.info={isWebGl2Supported:!1}},function(m){m[$[164]]=function(k){k=k||{};return{canvas:k.canvas||$d[$[110]]("canvas"),contextAttributes:$o.assign({powerPreference:"high-performance",preserveDrawingBuffer:!0,},k[$[162]]||{})}};m[$[67]]=function(k){k=k||{};return{locations:k[$[22]]||[],precision:k[$[45]]||"lowp",context:k.context||new AGL.Context()}};m[$[41]]=function(w){return"#version 300 es\nprecision "+w+" float;\n"};m.initApplication=function(r){function y(g){if($d.readyState==="complete"){$d[$[53]]($[163],B);var b=$d[$[110]]("canvas").getContext("webgl2");if(b){this.info.isWebGl2Supported=!0;this.info[$[93]]=b.getParameter(34930)};b=$n;r(this.info.isWebGl2Supported)}else if(!g)$d[$[53]]($[163],B)};var B=y.bind(this,!0);y()};m.loadShader=function(x,b,z){var l=b.createShader(x);b.shaderSource(l,z);b.compileShader(l);var s=b.getShaderParameter(l,35713);if(!s){var t=b.getShaderInfoLog(l);$c.log("Error compiling shader "+x+": "+t);b.deleteShader(l);return $n};return l};m[$[152]]=function(b,n,p,v){var q=b[$[152]]();_.map(n,function(c,l){b.attachShader(q,l)});if(p){_.map(p,function(c,j){b.bindAttribLocation(q,v?v[c]:c,j)})};b.linkProgram(q);var h=b.getProgramParameter(q,35714);if(!h){var t=b.getProgramInfoLog(q);$c.log("Error in program linking: "+t);b.deleteProgram(q);return $n};return q};m.getLocationsFor=function(b,q,C){var A={a:"Attrib",u:"Uniform"};var v={};_.map(C,function(c,d){v[d]=b["get"+A[d[0]]+"Location"](q,d)});return v};m.GLSL_RANDOM="float rand(vec2 xy,float seed){return fract(tan(distance(xy*1.61803398874989484820459,xy)*seed)*(xy.x+.01));}"}))();AGL[$[3]]=function(c,b){return{funcName:"blendFunc"+(c.length<3?"":"Separate"),funcs:c,eqName:"blendEquation"+(!b||b.length<2?"":"Separate"),eqs:b||[32774]}};AGL.BlendMode=_[$[79]]({NONE:AGL[$[3]]([0,0]),SIMPLE:AGL[$[3]]([1,1]),NORMAL_PM:AGL[$[3]]([1,771]),ADD_PM:AGL[$[3]]([1,1]),MULTIPLY_PM:AGL[$[3]]([774,771,1,771]),SCREEN_PM:AGL[$[3]]([1,769,1,771]),ADD_NPM:AGL[$[3]]([770,1,1,1]),SRC_IN:AGL[$[3]]([772,0]),SRC_OUT:AGL[$[3]]([773,0]),SRC_ATOP:AGL[$[3]]([772,771]),DST_OVER:AGL[$[3]]([773,1]),DST_IN:AGL[$[3]]([0,770]),DST_OUT:AGL[$[3]]([0,771]),DST_ATOP:AGL[$[3]]([773,770]),XOR:AGL[$[3]]([773,771]),NORMAL:AGL[$[3]]([770,771,1,771]),ADD:AGL[$[3]]([770,772,1,772]),MULTIPLY:AGL[$[3]]([774,771]),SCREEN:AGL[$[3]]([770,769,1,769]),OVERLAY:AGL[$[3]]([1,771]),EXCLUSION:AGL[$[3]]([775,769])});AGL[$[72]]=_[$[0]]($o,function b(){this[$[5]]=0},function(){});AGL[$[37]]=_[$[0]](AGL[$[72]],function f(){AGL[$[72]].call(this);this[$[32]]=this[$[69]]=this[$[85]]=this[$[84]]=this._x=this._y=this[$[63]]=this._anchorX=this._anchorY=this._skewX=this._skewY=0;this[$[88]]=this[$[90]]=1},function(b){_[$[1]](b,"x",{get:function(){return this._x},set:function(v){if(this._x!==v){this._x=v;++this[$[5]]}}});_[$[1]](b,"y",{get:function(){return this._y},set:function(v){if(this._y!==v){this._y=v;++this[$[5]]}}});_[$[1]](b,"rotation",{get:function(){return this[$[63]]},set:function(v){if(this[$[63]]!==v){this[$[63]]=v;++this[$[32]]}}});_[$[1]](b,"anchorX",{get:function(){return this._anchorX},set:function(v){if(this._anchorX!==v){this._anchorX=v;++this[$[5]]}}});_[$[1]](b,"anchorY",{get:function(){return this._anchorY},set:function(v){if(this._anchorY!==v){this._anchorY=v;++this[$[5]]}}});_[$[1]](b,"skewX",{get:function(){return this._skewX},set:function(v){if(this._skewX!==v){this._skewX=v;++this[$[32]]}}});_[$[1]](b,"skewY",{get:function(){return this._skewY},set:function(v){if(this._skewY!==v){this._skewY=v;++this[$[32]]}}});b[$[145]]=function(){if(this[$[69]]<this[$[32]]){this[$[69]]=this[$[32]];++this[$[5]];if(this._skewX===0&&this._skewY===0){this[$[85]]=this[$[84]]=Math.sin(this[$[63]]);this[$[88]]=this[$[90]]=Math.cos(this[$[63]])}else{var c=this[$[63]]-this._skewX;var d=this[$[63]]+this._skewY;this[$[85]]=Math.sin(d);this[$[88]]=Math.cos(d);this[$[84]]=Math.sin(c);this[$[90]]=Math.cos(c)}}}});AGL.ColorProps=_[$[0]](AGL[$[72]],function f(){AGL[$[72]].call(this);this.items=[1,1,1,1]},function(d){_[$[1]](d,"r",{get:function(){return this.items[0]},set:function(c){if(this.items[0]!==c){this.items[0]=c;++this[$[5]]}}});_[$[1]](d,"g",{get:function(){return this.items[1]},set:function(c){if(this.items[1]!==c){this.items[1]=c;++this[$[5]]}}});_[$[1]](d,"b",{get:function(){return this.items[2]},set:function(c){if(this.items[2]!==c){this.items[2]=c;++this[$[5]]}}});_[$[1]](d,"a",{get:function(){return this.items[3]},set:function(c){if(this.items[3]!==c){this.items[3]=c;++this[$[5]]}}});d.set=function(r,g,b,a){this.r=r;this.g=g;this.b=b;this.a=a}});AGL.ItemProps=_[$[0]](AGL[$[37]],function c(){AGL[$[37]].call(this);this[$[23]]=this[$[83]]=0;this[$[94]]=this[$[81]]=this._scaleX=this._scaleY=this[$[7]]=this[$[6]]=this.alpha=1},function(b){_[$[1]](b,"scaleX",{get:function(){return this._scaleX},set:function(v){if(this._scaleX!==v){this._scaleX=v;++this[$[23]]}}});_[$[1]](b,"scaleY",{get:function(){return this._scaleY},set:function(v){if(this._scaleY!==v){this._scaleY=v;++this[$[23]]}}});_[$[1]](b,"width",{get:function(){return this[$[7]]},set:function(v){if(this[$[7]]!==v){this[$[7]]=v;++this[$[23]]}}});_[$[1]](b,$[10],{get:function(){return this[$[6]]},set:function(v){if(this[$[6]]!==v){this[$[6]]=v;++this[$[23]]}}});b.updateScale=function(){if(this[$[83]]<this[$[23]]){this[$[83]]=this[$[23]];++this[$[5]];this[$[94]]=this[$[7]]*this._scaleX;this[$[81]]=this[$[6]]*this._scaleY}}});AGL.LightProps=_[$[0]](AGL.ItemProps,function c(){AGL.ItemProps.call(this);this.z=0},function(b){_[$[1]](b,"width",{get:function(){return this[$[7]]},set:function(v){if(this[$[7]]!==v){this[$[7]]=this[$[6]]=v;++this[$[23]]}}});_[$[1]](b,$[10],{get:function(){return this[$[6]]},set:function(v){}})});AGL.TextureCrop=_[$[0]](AGL[$[72]],function d(){AGL[$[72]].call(this);this[$[16]]=0;this.items=[0,0,1,1];this[$[7]]=this[$[6]]=1},function(c){_[$[1]](c,"x",{get:function(){return this.items[0]},set:function(v){if(this.items[0]!==v){this.items[0]=v;++this[$[5]]}}});_[$[1]](c,"y",{get:function(){return this.items[1]},set:function(v){if(this.items[1]!==v){this.items[1]=v;++this[$[5]]}}});_[$[1]](c,"width",{get:function(){return this[$[7]]},set:function(v){if(this[$[7]]!==v){this[$[7]]=v;++this[$[5]]}}});_[$[1]](c,$[10],{get:function(){return this[$[6]]},set:function(v){if(this[$[6]]!==v){this[$[6]]=v;++this[$[5]]}}});c.updateCrop=function(){if(this[$[16]]<this[$[5]]){this[$[16]]=this[$[5]];this.items[2]=this[$[7]]-this.items[0];this.items[3]=this[$[6]]-this.items[1]}};c.setRect=function(b){this.x=b.x;this.y=b.y;this.width=b.width;this[$[10]]=b[$[10]]}});AGL.TextureProps=_[$[0]](AGL[$[37]],function c(){AGL[$[37]].call(this);this._repeatX=this._repeatY=1;this.items=[0,0]},function(b){_.get(b,$[94],function(){return this._repeatX});_.get(b,$[81],function(){return this._repeatY});_[$[1]](b,"repeatX",{get:function(){return this._repeatX},set:function(v){if(this._repeatX!==v){this._repeatX=v;++this[$[5]]}}});_[$[1]](b,"repeatY",{get:function(){return this._repeatY},set:function(v){if(this._repeatY!==v){this._repeatY=v;++this[$[5]]}}});_[$[1]](b,"repeatRandomRotation",{get:function(){return this.items[0]},set:function(v){this.items[0]=v}});_[$[1]](b,"repeatRandomColorization",{get:function(){return this.items[1]},set:function(v){this.items[1]=v}})});AGL.DistortionProps=_[$[0]]($o,function c(){this.items=[0,0,1,0,1,1,0,1]},function(b){_[$[1]](b,"topLeftX",{get:function(){return this.items[0]},set:function(v){this.items[0]=v}});_[$[1]](b,"topLeftY",{get:function(){return this.items[1]},set:function(v){this.items[1]=v}});_[$[1]](b,"topRightX",{get:function(){return this.items[2]},set:function(v){this.items[2]=v}});_[$[1]](b,"topRightY",{get:function(){return this.items[3]},set:function(v){this.items[3]=v}});_[$[1]](b,"bottomRightX",{get:function(){return this.items[4]},set:function(v){this.items[4]=v}});_[$[1]](b,"bottomRightY",{get:function(){return this.items[5]},set:function(v){this.items[5]=v}});_[$[1]](b,"bottomLeftX",{get:function(){return this.items[6]},set:function(v){this.items[6]=v}});_[$[1]](b,"bottomLeftY",{get:function(){return this.items[7]},set:function(v){this.items[7]=v}})});AGL[$[104]]=_[$[0]](_[$[4]],function g(){_[$[4]].call(this);this.target=3553;this[$[51]]=-1;this[$[71]]=this[$[59]]=this[$[16]]=0;this[$[127]]=$n;this.wrapS=this.wrapT=33071;this.internalFormat=this.format=6408;this.minFilter=this.magFilter=9728;this[$[7]]=this[$[6]]=1;this.type=5121},function(d,f){_.get(d,"width",function(){return this[$[7]]});_.get(d,$[10],function(){return this[$[6]]});_.get(d,$[173],function(){return this[$[172]]});_[$[1]](d,"minFilter",{get:function(){return this[$[150]]},set:function(v){if(this[$[150]]!==v){this[$[150]]=v;this[$[172]]=this[$[150]]===9729?9987:9984}}});d[$[78]]=function(b,c){this[$[55]](b,c);this[$[80]](b)};d.unbindTexture=function(b,c){this[$[55]](b,c);this[$[51]]=-1;b[$[136]](this.target,$n)};d[$[55]]=function(b,c){this[$[51]]=c;b[$[55]](33984+c)};d[$[165]]=function(b,c){this[$[55]](b,c);b[$[136]](this.target,this[$[65]])};d[$[80]]=function(b){b[$[136]](this.target,this[$[65]]);this.uploadTexture(b)};d.uploadTexture=function(b){b.texImage2D(this.target,0,this.internalFormat,this.width,this[$[10]],0,this.format,this.type,this[$[127]]);b[$[74]](this.target,33085,0);b.generateMipmap(this.target);b[$[74]](this.target,10242,this.wrapS);b[$[74]](this.target,10243,this.wrapT);b[$[74]](this.target,10241,this[$[173]]);b[$[74]](this.target,10240,this.magFilter)}});AGL.Texture=_[$[0]](AGL[$[104]],function l(h,q){AGL[$[104]].call(this);this[$[56]]=this[$[168]].bind(this);this.source=h;this.shouldUpdate=q;this[$[26]]=0;this[$[116]]},function(j,k){_.get(j,"loaded",function(){return this._loaded});_.get(j,"width",function(){return this[$[139]]()||1});_.get(j,$[10],function(){return this[$[131]]()||1});_[$[1]](j,"source",{get:function(){return this[$[14]]},set:function(v){if(v){this._loaded=!1;this[$[14]]&&this[$[14]][$[62]](this[$[116]],this[$[56]]);this[$[14]]=v;this.isVideo=this._getSourceType()==="video";this[$[116]]=this.isVideo?"canplay":"load";this[$[122]]();this[$[14]][$[53]](this[$[116]],this[$[56]])}}});j.use=function(b,c,p,n){if(this._isNeedToDraw(b,p))this[$[78]](b,c);else if(this[$[51]]!==c||n)this[$[165]](b,c)};j._isNeedToDraw=function(b,p){if(this[$[71]]<b.agl_id){this[$[71]]=b.agl_id;this[$[65]]=b.createTexture();return!0};if(this.shouldUpdate&&this[$[26]]<p){this[$[26]]=p;return!0};if(this[$[16]]<this[$[59]]){this[$[16]]=this[$[59]];return!0};if(this.isVideo&&!this[$[14]].paused)return!0;return!1};j[$[8]]=function(){this[$[14]]&&this[$[14]][$[62]](this[$[116]],this[$[56]]);k[$[8]].call(this)};j[$[139]]=function(){return this[$[14]]?this[$[14]].naturalWidth||this[$[14]].videoWidth||this[$[14]].width:0};j[$[131]]=function(){return this[$[14]]?this[$[14]].naturalHeight||this[$[14]].videoHeight||this[$[14]][$[10]]:0};j[$[122]]=function(){this._loaded=this[$[139]]()>0&&this[$[131]]()>0;if(this._loaded){this[$[127]]=this[$[14]];++this[$[59]]}else this[$[127]]=$n};j._getSourceType=function(){return this[$[14]].tagName?this[$[14]].tagName.toLowerCase():""};j[$[168]]=j[$[122]]});AGL.Texture.loadImage=function(d,q){var f=$d[$[110]]("img");var m=new AGL.Texture(f,q);f.src=d;return m};AGL.Texture.loadVideo=function(d,q){var g=$d[$[110]]("video");var m=new AGL.Texture(g,q);g.src=d;return m};AGL[$[102]]=_[$[0]](AGL[$[104]],function j(){AGL[$[104]].call(this,!1)},function(d,f){_[$[1]](d,"width",{get:function(){return this[$[7]]},set:function(v){if(this[$[7]]!==v&&v>0){this[$[7]]=v;++this[$[59]]}}});_[$[1]](d,$[10],{get:function(){return this[$[6]]},set:function(v){if(this[$[6]]!==v&&v>0){this[$[6]]=v;++this[$[59]]}}});d.setSize=function(w,h){this.width=w;this[$[10]]=h};d.bind=function(b){b.bindFramebuffer(36160,this[$[89]])};d.unbind=function(b){b.bindFramebuffer(36160,$n)};d.use=function(b,c){!this._update(b,c)&&this[$[51]]!==c&&this._use(b,c)};d._use=function(b,c){this[$[55]](b,c);b[$[136]](this.target,this[$[65]])};d._update=function(b,c){var g=!1;if(this[$[71]]<b.agl_id){this[$[71]]=b.agl_id;this[$[89]]=b.createFramebuffer();this[$[65]]=b.createTexture();this[$[78]](b,c);this.bind(b);b.framebufferTexture2D(36160,36064,3553,this[$[65]],0);this.unbind(b);g=!0};if(this[$[16]]<this[$[59]]){this[$[16]]=this[$[59]];this[$[78]](b,c);g=!0};return g}});AGL.Context=_[$[0]](_[$[4]],function p(m){_[$[4]].call(this);this.contextId=0;this._config=AGL.Utils[$[164]](m||{});this[$[48]]=this._config.canvas;this[$[169]]=AGL.Utils.info[$[93]];this[$[98]]=this._onContextLost.bind(this);this[$[70]]=this[$[158]].bind(this);this[$[154]]=this._restoreContext.bind(this);this[$[48]][$[53]]($[161],this[$[98]]);this[$[48]][$[53]]($[151],this[$[70]]);this[$[158]]()},function(k,l){_.get(k,"canvas",function(){return this[$[48]]});_.get(k,$[54],function(){return this.gl&&this.gl[$[54]]&&this.gl[$[54]]()});k.useBlendMode=function(s){this[$[166]]=s;var c=s.eqs;var g=s.funcs;this.gl[s.eqName](c[0],c[1]);this.gl[s.funcName](g[0],g[1],g[2],g[3])};k[$[126]]=function(s,x){if(this[$[166]]!==s){x&&x();this.useBlendMode(s)}};k[$[8]]=function(){this.gl[$[119]]($n);this[$[48]][$[62]]($[161],this[$[98]]);this[$[48]][$[62]]($[151],this[$[70]]);this[$[57]]&&this[$[57]].loseContext();l[$[8]].call(this)};k[$[113]]=function(){for(var i=0;i<this[$[169]];++i){this[$[99]][i]=$n;this[$[27]][i]=i};this[$[117]].length=0};k[$[80]]=function(w,v,t,q){if(!w)return-1;var r=this[$[99]].indexOf(w);if(r<0){r=this[$[27]][0];t=!0};if(this[$[27]].length<1){q&&q();this[$[113]]();r=0;t=!0};return this[$[86]](w,r,v,t)};k[$[86]]=function(w,r,v,t){if(!w)return-1;w.use(this.gl,r,v,t);this[$[99]][r]=w;var y=this[$[117]].indexOf(r);y<0&&this[$[117]].push(r);var z=this[$[27]].indexOf(r);z>-1&&this[$[27]].splice(z,1);return r};k[$[123]]=function(w){var r=w?this[$[99]].indexOf(w):-1;r>-1&&w.unbindTexture(this.gl,r)};k[$[119]]=function(n,d){if(this._currentProgram!==n){this._currentProgram=n;this[$[113]]();var b=this.gl;b.bindVertexArray($n);b[$[119]](n);b.bindVertexArray(d);return!0};return!1};k._onContextLost=function(h){h.preventDefault();this[$[57]]&&setTimeout(this[$[154]],1)};k._restoreContext=function(){this[$[57]].restoreContext()};k[$[158]]=function(){++this.contextId;var b=this.gl=this[$[48]].getContext("webgl2",this._config[$[162]]);b.agl_id=this.contextId;this[$[57]]=b.getExtension('WEBGL_lose_context');b.pixelStorei(37441,!0);b.enable(3042);b.enable(3089);this[$[99]]=[];this[$[27]]=[];this[$[117]]=[];this[$[113]]()};k.setCanvasSize=function(f,j){this[$[48]].width!==f&&(this[$[48]].width=f);this[$[48]][$[10]]!==j&&(this[$[48]][$[10]]=j)};k.setSize=function(f,j){if(this.width!==f||this[$[10]]!==j){this.width=f;this[$[10]]=j;this.gl.scissor(0,0,f,j);this.gl.viewport(0,0,f,j);return!0};return!1}});AGL.Buffer=_[$[0]](_[$[4]],function j(s,d,f,g,k,h,p){_[$[4]].call(this);var l=f*g;this.data=typeof d==="number"?new F32A(d*l):d;this._locationName=s;this._rows=f;this._cols=g;this._target=k||34962;this._type=h||35048;this._length=l*4;this._offset=g*4;this._divisor=typeof p==="number"?p:1;if(this._type===35044){this._length=this._offset=0}},function(m){m.create=function(b){this._buffer=b.createBuffer();this.bind(b)};m.bind=function(b){b.bindBuffer(this._target,this._buffer)};m.upload=function(b,n,r){this.bind(b);n&&this._enable(b,r);b.bufferData(this._target,this.data,this._type)};m.enable=function(b,r){this.bind(b);this._enable(b,r)};m._enable=function(b,r){var q=r[this._locationName];var i=-1;while(++i<this._rows){var c=q+i;b.enableVertexAttribArray(c);b.vertexAttribPointer(c,this._cols,5126,!1,this._length,i*this._offset);b.vertexAttribDivisor(c,this._divisor)}}});AGL.FPS={start:function(c){this._targetMS=0;this._then=0;this._frames=0;this._prevTime=0;this._then=Date.now();this._targetMS=1000/(c||60);this.fps=this.delay=0},update:function(){this._frames++;var b=Date.now();this.delay=(b-this._then)/this._targetMS;if(b>=this._prevTime+1000){this.fps=(this._frames*1000)/(b-this._prevTime);this._prevTime=b;this._frames=0};this._then=b}};AGL.Matrix3={identity:function(){return new F32A([1,0,0,1,0,0])},projection:function(c,h,z){z[0]=2/c;z[1]=z[2]=0;z[3]=-2/h;z[4]=-1;z[5]=1},transformLocal:function(d,z){var j=d.anchorX;var k=d.anchorY;var q=d[$[94]];var w=d[$[81]];z[0]=d[$[88]]*q;z[1]=d[$[85]]*q;z[2]=-d[$[84]]*w;z[3]=d[$[90]]*w;z[4]=d.x-j*z[0]-k*z[2];z[5]=d.y-j*z[1]-k*z[3]},transform:function(g,d,z){var x=d.x;var y=d.y;var j=d.anchorX;var k=d.anchorY;var r=d[$[85]];var v=d[$[84]];var t=d[$[88]];var s=d[$[90]];var q=d[$[94]];var w=d[$[81]];z[0]=(t*g[0]+r*g[2])*q;z[1]=(t*g[1]+r*g[3])*q;z[2]=(s*g[2]-v*g[0])*w;z[3]=(s*g[3]-v*g[1])*w;z[4]=-j*z[0]-k*z[2]+x*g[0]+y*g[2]+g[4];z[5]=-j*z[1]-k*z[3]+x*g[1]+y*g[3]+g[5]},inverse:function(g,z){var b=1/(g[0]*g[3]-g[2]*g[1]);z[0]=b*g[3];z[1]=-b*g[1];z[2]=-b*g[2];z[3]=b*g[0];z[4]=b*(g[2]*g[5]-g[3]*g[4]);z[5]=-b*(g[0]*g[5]-g[1]*g[4])},isPointInMatrix:function(g,f){var x=f.x*g[0]+f.y*g[2]+g[4];var y=f.x*g[1]+f.y*g[3]+g[5];return x>=0&&x<=1&&y>=0&&y<=1},calcCorners:function(g,l,p){var m=p.widthHalf;var n=p.heightHalf;l[0].x=m+g[4]*m;l[0].y=p[$[10]]-(n+g[5]*n);l[1].x=l[0].x+(g[0]+g[2])*m;l[1].y=l[0].y-(g[1]+g[3])*n;l[2].x=l[0].x+(g[0]+m*g[2]);l[2].y=l[0].y-(g[1]+n*g[3]);l[3].x=l[0].x+(m*g[0]+g[2]);l[3].y=l[0].y-(n*g[1]+g[3])}};AGL.Point={create:function(x,y){return{x:x||0,y:y||0}}};AGL.Rect={create:function(x,y,c,d){return{x:x||0,y:y||0,width:c||0,height:d||0}},toRelativeSize:function(b,c,d){return{x:b.x/c,y:b.y/d,width:b.width/c,height:b[$[10]]/d}}};AGL.BaseItem=_[$[0]](_[$[4]],function b(){_[$[4]].call(this);this[$[17]]=AGL.Matrix3.identity();this[$[109]]=this[$[18]]=0;this[$[66]]=[1,1,1,1]});AGL.Item=_[$[0]](AGL.BaseItem,function b(){AGL.BaseItem.call(this);this.TYPE=AGL.Item.TYPE;this.renderable=!0;this.props=new AGL.ItemProps();this.color=new AGL.ColorProps();this[$[82]]=this[$[31]]=this[$[29]]=this[$[28]]=this[$[9]]=0;this.callback=_[$[13]];this._bounds=AGL.Rect.create()},function(d,f){_.get(d,"stage",function(){return this[$[38]]?this[$[38]].stage:$n});_[$[1]](d,"parent",{get:function(){return this[$[38]]},set:function(v){if(this[$[38]]!==v){this[$[38]]=v;this[$[29]]=this[$[28]]=this[$[9]]=0}}});_[$[1]](d,"callback",{get:function(){return this._callback},set:function(v){if(this._callback!==v)this._callback=v||_[$[13]]}});d.getBounds=function(){return this._bounds};d[$[8]]=function(){this[$[38]]&&this[$[38]][$[103]]&&this[$[38]][$[103]](this);f[$[8]].call(this)};d.update=function(){this[$[91]]()};d[$[91]]=function(){var c=this.props;c[$[145]]();c.updateScale();var g=this[$[38]];(this[$[29]]<g[$[18]]||this[$[82]]<c[$[5]])&&this[$[76]](c,g)};d[$[76]]=function(c,g){this[$[29]]=g[$[18]];this[$[82]]=c[$[5]];++this[$[18]];AGL.Matrix3.transform(g[$[17]],c,this[$[17]])}});AGL.Item.TYPE="item";AGL[$[87]]=_[$[0]](AGL.Item,function k(h){AGL.Item.call(this);this[$[96]]=new F32A(6);this._corners=[AGL.Point.create(),AGL.Point.create(),AGL.Point.create(),AGL.Point.create()]},function(f){f.getCorners=function(){this[$[30]]();return this._corners};f.getBounds=function(){this[$[30]]();return this._bounds};f[$[157]]=function(){AGL.Matrix3.calcCorners(this[$[17]],this._corners,this.stage.renderer)};f._calcBounds=function(){this[$[157]]();var j=this._corners;var g=this._bounds;var a=j[0];var b=j[1];var c=j[2];var d=j[3];g.x=Math.min(a.x,b.x,c.x,d.x);g.y=Math.min(a.y,b.y,c.y,d.y);g.width=Math.max(a.x,b.x,c.x,d.x);g[$[10]]=Math.max(a.y,b.y,c.y,d.y)};f[$[30]]=function(){if(this[$[9]]<this[$[18]]){this[$[9]]=this[$[18]];AGL.Matrix3.inverse(this[$[17]],this[$[96]]);this._calcBounds()}}});AGL.Light=_[$[0]](AGL[$[87]],function l(f,r,s){AGL[$[87]].call(this);this.props=new AGL.LightProps();this.color.a=0;this._id=f;this._matId=f*16;this._colId=this._matId+8;this._datId=this._matId+12;this._extId=f*4;this[$[47]]=r;this[$[35]]=s;this[$[144]]=this._gouraud=!0;this.angle=0;this.spotAngle=180*AGL.Utils.THETA;this.castShadow=this.gouraud=!0;this.type=AGL.Light.Type.SPOT;this[$[45]]=2},function(n,m){_[$[1]](n,"type",{get:function(){return this[$[35]][this._extId]},set:function(v){this[$[35]][this._extId]=v}});_[$[1]](n,"castShadow",{get:function(){return this[$[144]]},set:function(v){this[$[144]]=v;this[$[106]]()}});_[$[1]](n,"gouraud",{get:function(){return this._gouraud},set:function(v){this._gouraud=v;this[$[106]]()}});_[$[1]](n,$[45],{get:function(){return this[$[35]][this._extId+3]},set:function(v){this[$[35]][this._extId+3]=Math.max(1,v)}});_[$[1]](n,"angle",{get:function(){return this[$[47]][this._datId+3]},set:function(v){this[$[47]][this._datId+3]=v}});_[$[1]](n,"spotAngle",{get:function(){return this[$[47]][this._matId+7]},set:function(v){this[$[47]][this._matId+7]=v}});n.isOn=function(){return this.renderable&&this.stage!==$n};n[$[106]]=function(){this[$[35]][this._extId+1]=this[$[144]]*1|this._gouraud*2};n[$[30]]=function(){if(this.isOn()&&this[$[9]]<this[$[18]]){this[$[9]]=this[$[18]];this._calcBounds()}};n[$[157]]=function(){AGL.Matrix3.calcCorners(this[$[17]],this._corners,this.stage.renderer);var q=this._corners;var a=q[0];var b=q[1];var c=q[2];var d=q[3];a.x+=(a.x-d.x)+(a.x-c.x);a.y+=(a.y-d.y)+(a.y-c.y);c.x+=(c.x-b.x);c.y+=(c.y-b.y);d.x+=(d.x-b.x);d.y+=(d.y-b.y)};n.update=function(){var r=this[$[47]];var k=this._datId;if(this.isOn()){this[$[91]]();this[$[129]]();r[k]=r[k-1]>0?1:0;r[k+2]=this.props.alpha;r[this._matId+6]=this.props.width;this[$[35]][this._extId+2]=this.props.z}else r[k]=0};n[$[76]]=function(j,p){m[$[76]].call(this,j,p);_[$[39]](this[$[47]],this[$[17]],this._matId)};n[$[129]]=function(){var h=this.color;if(this[$[31]]<h[$[5]]){this[$[31]]=h[$[5]];var r=this[$[47]];var t=this[$[38]][$[66]];var g=this._colId;var w=t[3]*h.a;r[g]=t[0]*h.r*w;r[g+1]=t[1]*h.g*w;r[g+2]=t[2]*h.b*w;r[g+3]=w}}});AGL.Light.Type=_[$[79]]({SPOT:0,AMBIENT:1});AGL.Image=_[$[0]](AGL[$[87]],function b(g){AGL[$[87]].call(this);this.TYPE=AGL.Image.TYPE;this[$[105]]=AGL.Matrix3.identity();this.tintType=AGL.Image.TintType.NONE;this.blendMode=AGL.BlendMode.NORMAL;this[$[159]]=new AGL.TextureProps();this[$[135]]=new AGL.TextureCrop();this.distortionProps=new AGL.DistortionProps();this[$[50]]=0;this[$[171]]=this[$[135]].items;this[$[134]]=this[$[159]].items;this[$[155]]=this.distortionProps.items;this[$[66]]=this.color.items;this[$[64]]=g},function(f){f.update=function(){this[$[91]]();this._updateTexture();this[$[135]].updateCrop()};f.isContainsPoint=function(c){this[$[30]]();return AGL.Matrix3.isPointInMatrix(this[$[96]],c)};f._updateTexture=function(){var d=this[$[159]];d[$[145]]();if(this[$[50]]<d[$[5]]){this[$[50]]=d[$[5]];AGL.Matrix3.transformLocal(d,this[$[105]])}}});AGL.Image.TYPE="drawable";AGL.Image.TintType=_[$[79]]({NONE:0,NORMAL:1,GRAYSCALE:2,OVERRIDE:3});AGL.AnimatedImage=_[$[0]](AGL.Image,function j(f){AGL.Image.call(this,f);this.frameLength=120;this.frames=[];this.frame=this[$[26]]=0;this[$[60]];this.stop()},function(c,d){_.get(c,"isPlaying",function(){return this[$[60]]===this[$[130]]});c.gotoAndStop=function(b){this.stop();this.frame=b;this[$[132]]()};c.gotoAndPlay=function(b){this.frame=b;this.play()};c.stop=function(){this[$[60]]=_[$[13]]};c.play=function(){this[$[60]]=this[$[130]]};c.update=function(g){d.update.call(this);this[$[60]](g)};c[$[130]]=function(g){var h=g-this[$[26]];if(h>this.frameLength){this[$[26]]=g;this.frame+=~~(h/this.frameLength);this.frame>=this.frames.length&&(this.frame=0);this[$[132]]()}};c[$[132]]=function(){this[$[135]].setRect(this.frames[this.frame])};c[$[8]]=function(){this.stop();d[$[8]].call(this)}});AGL[$[100]]=_[$[0]](AGL.Item,function n(){AGL.Item.call(this);this.TYPE=AGL[$[100]].TYPE;this[$[33]]=[]},function(k,g){k[$[8]]=function(){this.empty();g[$[8]].call(this)};k.empty=function(){while(this[$[33]].length)this.removeChildAt(0)};k.contains=function(b){return this[$[115]](b)>-1};k.addChild=function(b){return this.addChildAt(b,this[$[33]].length)};k.addChildAt=function(b,c){if(b){b.parent&&b.parent[$[103]](b);this[$[33]].push(b);this[$[114]](b,c);b.parent=this};return b};k[$[103]]=function(b){if(b){_[$[141]](this[$[33]],b);b.parent=$n};return b};k.removeChildAt=function(c){return this[$[103]](this.getChildAt(c))};k.getChildAt=function(c){return this[$[33]][c]};k[$[114]]=function(b,c){_[$[141]](this[$[33]],b);this[$[33]].splice(c,0,b);return b};k[$[115]]=function(b){return this[$[33]].indexOf(b)};k.swapChildren=function(h,j){var s=this[$[115]](h);var q=this[$[115]](j);if(s<0||q<0)return!1;this[$[114]](h,q);this[$[114]](j,s);return!0};k.getBounds=function(){var m=this._bounds;m.x=1/0;m.y=1/0;m.width=-1/0;m[$[10]]=-1/0;var l=this[$[33]].length;for(var i=0;i<l;++i){var r=this[$[33]][i].getBounds();m.x=Math.min(m.x,r.x);m.y=Math.min(m.y,r.y);m.width=Math.max(m.width,r.width);m[$[10]]=Math.max(m[$[10]],r[$[10]])};return m};k.update=function(){this[$[91]]();this[$[129]]()};k[$[129]]=function(){var f=this[$[38]];var d=this.color;if(this[$[28]]<f[$[109]]||this[$[31]]<d[$[5]]){this[$[31]]=d[$[5]];this[$[28]]=f[$[109]];++this[$[109]];var p=this[$[66]];var t=f[$[66]];p[0]=t[0]*d.r;p[1]=t[1]*d.g;p[2]=t[2]*d.b;p[3]=t[3]*d.a}}});AGL[$[100]].TYPE="container";AGL.StageContainer=_[$[0]](AGL[$[100]],function d(c){AGL[$[100]].call(this);this.renderer=c;this[$[38]]=new AGL.BaseItem()},function(b){_.get(b,"stage",function(){return this});_.get(b,"parent",function(){return this[$[38]]})});AGL.SmoothLight=_[$[0]](_[$[4]],function g(d){d=d||{};_[$[4]].call(this);this[$[89]]=new AGL[$[102]]();this[$[12]]=new AGL[$[153]](d);this[$[12]][$[40]].set(0,0,0,1);this[$[12]][$[118]]=!0;this[$[137]]=new AGL.BlurFilter();this[$[20]]=new AGL[$[148]]({config:{context:this[$[12]].context,},texture:this[$[89]],filters:[this[$[137]]]});this[$[20]][$[40]].set(0,0,0,0);this[$[20]][$[118]]=!0;this.image=new AGL.Image();this.image.blendMode=AGL.BlendMode.MULTIPLY;if(!d.config.context){this.image[$[64]]=new AGL.Texture(this[$[20]].context.canvas,!0);this[$[124]]=this._renderFilter.bind(this)}else{this[$[108]]=new AGL[$[102]]();this.image[$[64]]=this[$[108]];this[$[124]]=this[$[121]].bind(this)};this.blur=_.isEmpty(d.blur)?1:d.blur},function(b,c){_[$[1]](b,"scale",{get:function(){return this[$[12]].scale},set:function(v){if(this[$[12]].scale!==v){this[$[12]].scale=v;this[$[138]]=this._resize}}});_[$[1]](b,"blur",{get:function(){return this._blur},set:function(v){if(this._blur!==v){this._blur=v;var f=this[$[137]];f.intensityX=f[$[146]]=this._blur}}});b.render=function(){this[$[138]]();this[$[12]][$[58]](this[$[89]]);this[$[124]]()};b._renderFilter=function(){this[$[20]].render()};b[$[121]]=function(){this[$[20]][$[58]](this[$[108]])};b.setSize=function(w,h){this[$[7]]=w;this[$[6]]=h;this[$[138]]=this._resize};b[$[8]]=function(){this[$[12]][$[8]]();this[$[20]][$[8]]();this[$[137]][$[8]]();this.image[$[8]]();c[$[8]].call(this)};b._resize=function(){this[$[138]]=_[$[13]];var j=this[$[7]]*this[$[12]].scale;var k=this[$[6]]*this[$[12]].scale;this.image.props.width=this[$[7]];this.image.props[$[10]]=this[$[6]];this[$[12]].setSize(j,k);this[$[20]].setSize(j,k)}});AGL[$[92]]=_[$[0]](_[$[4]],function l(j){_[$[4]].call(this);this[$[25]]=_[$[13]];this[$[40]]=new AGL.ColorProps();this[$[125]]=this[$[44]]=this[$[95]]=this[$[133]]=0;this._options=j;this._config=this._options.config;this[$[11]]=this._config.context;this._config[$[22]]=this._config[$[22]].concat(["uFlpY","aPos","uTex"]);this._vao=this[$[11]].gl.createVertexArray();this[$[36]]=!1;this[$[97]]=new AGL.Buffer("",new Uint16Array([0,1,3,2]),0,0,34963,35044);this[$[143]]=new AGL.Buffer("aPos",new F32A([0,0,1,0,1,1,0,1]),1,2,34962,35044,0)},function(f,g){_.get(f,"context",function(){return this[$[11]]});_[$[1]](f,"width",{get:function(){return this[$[7]]},set:function(v){if(this[$[7]]!==v){this[$[7]]=v;this.widthHalf=v*.5;++this[$[95]]}}});_[$[1]](f,$[10],{get:function(){return this[$[6]]},set:function(v){if(this[$[6]]!==v){this[$[6]]=v;this.heightHalf=v*.5;++this[$[95]]}}});_[$[1]](f,$[118],{get:function(){return this[$[25]]===this._clear},set:function(v){this[$[25]]=v?this._clear:_[$[13]]}});f.setSize=function(c,h){this.width=c;this[$[10]]=h};f[$[58]]=function(k){if(!this[$[11]][$[54]]){this[$[75]]();this[$[68]](k);this[$[128]](k);k.unbind(this._gl)}};f.render=function(){if(!this[$[11]][$[54]]){this[$[75]]();this._gl.uniform1f(this[$[19]].uFlpY,1);this[$[128]]()}};f[$[128]]=function(k){this[$[44]]=Date.now();this[$[25]]();this._render(k);this._gl.flush()};f[$[75]]=function(){this._gl=this[$[11]].gl;if(this[$[125]]<this[$[11]].contextId){this[$[125]]=this[$[11]].contextId;this._buildProgram();this[$[36]]=!0}else if(this[$[11]][$[119]](this._program,this._vao))this[$[36]]=!0;this._resize()};f[$[68]]=function(k){k.setSize(this[$[7]],this[$[6]]);this[$[11]][$[80]](k,this[$[44]]);this[$[11]][$[123]](k);k.bind(this._gl);this[$[25]]();this._gl.uniform1f(this[$[19]].uFlpY,-1)};f._clear=function(){var m=this[$[40]];this._gl[$[40]](this[$[40]].r,this[$[40]].g,this[$[40]].b,this[$[40]].a);this._gl.clear(16384)};f._resize=function(){if(this[$[11]].setSize(this[$[7]],this[$[6]]))++this[$[95]];if(this[$[133]]<this[$[95]]){this[$[133]]=this[$[95]];this[$[111]]()}};f[$[111]]=_[$[13]];f[$[101]]=function(d){this._gl.drawElementsInstanced(5,4,5123,0,d)};f._buildProgram=function(){var b=this._gl;this._program=AGL.Utils[$[152]](b,[AGL.Utils[$[170]](b,this[$[61]](this._options)),AGL.Utils[$[160]](b,this[$[49]](this._options))]);this[$[19]]=AGL.Utils.getLocationsFor(b,this._program,this._config[$[22]]);this[$[11]][$[119]](this._program,this._vao);this[$[21]]()};f[$[15]]=function(){var b=this._gl;this[$[143]].upload(b,!0,this[$[19]]);this[$[97]].upload(b);this[$[36]]=!1};f[$[21]]=function(){var b=this._gl;this[$[97]].create(b);this[$[143]].create(b)}});AGL[$[73]]=_[$[0]](AGL[$[92]],function f(d){d.config[$[22]]=d.config[$[22]].concat(["aMt"]);AGL[$[92]].call(this,d);this[$[42]]=new AGL.Buffer("aMt",this[$[24]],4,4)},function(b,c){b[$[15]]=function(){this[$[42]].upload(this._gl,this[$[36]],this[$[19]]);c[$[15]].call(this)};b[$[21]]=function(){c[$[21]].call(this);this[$[42]].create(this._gl)}});AGL[$[148]]=_[$[0]](AGL[$[92]],function s(k){k=k||{};k.config=AGL.Utils[$[67]](k.config,AGL[$[148]]);k.config[$[22]]=k.config[$[22]].concat(["uFTex","uFtrT","uFtrV","uFtrK"]);this[$[24]]=1;AGL[$[92]].call(this,k);this.filters=k.filters||[];this[$[64]]=k[$[64]];this[$[112]]=[new AGL[$[102]](),new AGL[$[102]]()]},function(f,g){f[$[58]]=function(q){if(!this[$[11]][$[54]]){this[$[75]]();this[$[128]](q);q.unbind(this._gl)}};f[$[8]]=function(){this[$[112]][0][$[8]]();this[$[112]][1][$[8]]();g[$[8]].call(this)};f._render=function(q){var j=this[$[11]];var b=this._gl;var p=this[$[44]];var m=this[$[19]];j[$[126]](AGL.BlendMode.NORMAL);this[$[15]]();j[$[86]](this[$[64]],0,p,!0);b.uniform1i(m.uTex,0);var l=this.filters.length||1;var c=l-2;for(var i=0;i<l;++i){var h=this.filters[i];var n=h&&h.on;var t=$n;var d=i>c;var r=n&&h[$[64]];if(r){j[$[86]](r,1,p,!0);b.uniform1i(m.uFTex,1)};if(d){if(q)this[$[68]](q);else b.uniform1f(m.uFlpY,1)}else if(n){t=this[$[112]][i&1];this[$[68]](t)};if(n){b.uniform1fv(m.uFtrV,h.v);b.uniformMatrix3fv(m.uFtrK,!1,h.kernels);b.uniform2i(m.uFtrT,h.TYPE,h.SUB_TYPE)};(n||d)&&this[$[101]](1);r&&j[$[123]](r);if(t){t.unbind(b);j[$[86]](t,0,p,!0)}}};f[$[61]]=function(k){return AGL.Utils[$[41]](k.config[$[45]])+"in vec2 aPos;uniform float uFlpY;out vec2 vCrd;out vec2 vTCrd;void main(void){vec3 pos=vec3(aPos*2.-1.,1);gl_Position=vec4(pos,1);gl_Position.y*=uFlpY;vCrd=pos.xy;vTCrd=vec2(aPos.x,1.-aPos.y);}"};f[$[49]]=function(k){return AGL.Utils[$[41]](k.config[$[45]])+"uniform sampler2D uTex;uniform sampler2D uFTex;uniform ivec2 uFtrT;uniform float uFtrV[9];uniform mat3 uFtrK;in vec2 vCrd;in vec2 vTCrd;out vec4 oCl;void main(void){oCl=texture(uTex,vTCrd);if(uFtrT.x>0){float[] vl=uFtrV;vec2 oPx=1./vec2(textureSize(uTex,0));float val=vl[0];vec2 vol=val*oPx;if(uFtrT.x<2){mat3 kr=uFtrK*val;oCl=vec4((texture(uTex,vTCrd-oPx)*kr[0].x+texture(uTex,vTCrd+oPx*vec2(0,-1))*kr[0].y+texture(uTex,vTCrd+oPx*vec2(1,-1))*kr[0].z+texture(uTex,vTCrd+oPx*vec2(-1,0))*kr[1].x+oCl*kr[1].y+texture(uTex,vTCrd+oPx*vec2(1,0))*kr[1].z+texture(uTex,vTCrd+oPx*vec2(-1,1))*kr[2].x+texture(uTex,vTCrd+oPx*vec2(0,1))*kr[2].y+texture(uTex,vTCrd+oPx)*kr[2].z).rgb,oCl.a);}else if(uFtrT.x<3){if(uFtrT.y<2)oCl=vec4(vec3((oCl.r+oCl.g+oCl.b)/3.),oCl.a);else if(uFtrT.y<3)oCl=vec4(vec3(.874,.514,.156)*((oCl.r+oCl.g+oCl.b)/3.),oCl.a);else if(uFtrT.y<4)oCl=abs(vec4(oCl.rgb-1.,oCl.a));else if(uFtrT.y<5)oCl.rgb*=vec3(vl[2],vl[3],vl[4])*val;else if(uFtrT.y<6)oCl=vec4((round((oCl.rgb*256.)/val)/256.)*val,oCl.a);else if(uFtrT.y<7){vec2 pv=pow(abs(vCrd*val),vec2(vl[1]));float v=clamp(min(1.,(1.-length(pv))*vl[5]),0.,1.);oCl.rgb*=vec3(v);oCl.rgb+=vec3(vl[2],vl[3],vl[4])*(1.-v);}else if(uFtrT.y<8)oCl.rgb+=vec3(vCrd.xy*.15,(vCrd.x*vCrd.y)*.15);else if(uFtrT.y<9)oCl.rgb=vec3((oCl.rgb-.5)*vl[1]+.5+val);else if(uFtrT.y<10)oCl.rgb=vec3(pow(oCl.rgb,vec3(val)));}else if(uFtrT.x<4){vec2 wh=oPx*vec2(val,vl[1]);vec4 col=vec4(0);float c=0.;float m;float im;vec4 tCol;if(uFtrT.y<2)for(float i=-2.;i<3.;++i){for(float j=-2.;j<3.;++j){m=abs(i)+abs(j);im=1.-(m*.25);tCol=i==0.&&j==0.?oCl:texture(uTex,vTCrd+(wh*vec2(i,j)));col+=tCol*im;c+=im;}}else{float oAvg=uFtrT.y==2?(oCl.r+oCl.g+oCl.b+oCl.a)/4.:0.;for(float i=-2.;i<3.;++i){for(float j=-2.;j<3.;++j){m=abs(i)+abs(j);im=1.-(m*.25);tCol=i==0.&&j==0.?oCl:texture(uTex,vTCrd+(wh*vec2(i,j)));float avg=(tCol.r+tCol.g+tCol.b+tCol.a)/4.;if(avg-oAvg>=vl[3]*m){col+=tCol*im*(2.-vl[3]);c+=im;}}}}oCl=col/c;}else if(uFtrT.x<5)oCl=texture(uTex,floor(vTCrd/vol)*vol);else if(uFtrT.x<6){vec2 dspMd=vec2(1,-1)*(texture(uFTex,mod(vTCrd+vec2(vl[1],vl[2]),1.)).rg-.5)*2.*vol;oCl=texture(uTex,vTCrd+dspMd);}else if(uFtrT.x<7){vec4 mskCol=texture(uFTex,vTCrd);oCl.a*=val<4.?mskCol[int(val)]:(mskCol.r+mskCol.g+mskCol.b+mskCol.a)/4.;}}}"}});AGL[$[153]]=_[$[0]](AGL[$[73]],function j(g){g=g||{};g.config=AGL.Utils[$[67]](g.config,AGL[$[153]]);g.config[$[22]]=g.config[$[22]].concat(["aExt","uS","uSC"]);this.heightMap=g.heightMap;this[$[24]]=Math.max(1,g.lightNum||1);AGL[$[73]].call(this,g);this.scale=g.scale;this[$[77]]=new AGL.Buffer("aExt",this[$[24]],1,4);this._lights=[];for(var i=0;i<this[$[24]];++i)this._lights.push(new AGL.Light(i,this[$[42]].data,this[$[77]].data))},function(d,f){_[$[1]](d,"scale",{get:function(){return this._scale},set:function(v){v=Math.max(0,Math.min(1,v||1));this._scale=v}});d.getLight=function(b){return this._lights[b]};d._render=function(){var c=this._gl;var h=this[$[19]];this[$[11]][$[126]](AGL.BlendMode.ADD);this.heightMap&&c.uniform1i(h.uTex,this[$[11]][$[80]](this.heightMap,this[$[44]],!0));this[$[15]]();c.uniform1f(h.uSC,this._scale);this[$[101]](this._lights.length)};d[$[111]]=function(){this._gl.uniform4f(this[$[19]].uS,this[$[7]],this[$[6]],1/this[$[7]],1/this[$[6]])};d[$[15]]=function(){this[$[77]].upload(this._gl,this[$[36]],this[$[19]]);f[$[15]].call(this)};d[$[21]]=function(){f[$[21]].call(this);this[$[77]].create(this._gl)};d[$[61]]=function(g){return AGL.Utils[$[41]](g.config[$[45]])+"#define H vec4(1,-1,2,-2)\n#define PI radians(180.)\nin vec2 aPos;in mat4 aMt;in vec4 aExt;uniform vec4 uS;uniform float uFlpY;uniform float uSC;out vec2 vTCrd;out vec4 vCrd;out vec4 vCol;out vec4 vDat;out vec4 vExt;out vec4 vS;out float vHS;out float vD;out float vSpt;out float vSC;out vec2 vSln;void main(void){vExt=aExt;vCol=aMt[2];vDat=aMt[3];vS=uS;vSC=uSC;vec3 pos=vec3(aPos*2.-1.,1);vCrd.xy=pos.xy*vSC;vHS=vExt.z*vSC;mat3 mt=mat3(aMt[0].xy,0,aMt[0].zw,0,aMt[1].xy,1);if(vExt.x<1.){vExt.w*=vSC;gl_Position=vec4(mt*pos,1);vTCrd=(gl_Position.xy+H.xy)/H.zw;vCrd.zw=(aMt[1].xy+H.xy)/H.zw;vSpt=PI-aMt[1].w;vD=aMt[1].z*vSC;vSln=vec2(sin(vDat.w),cos(vDat.w));}else{mt[2].xy=vec2(-1,1);gl_Position=vec4(pos,1);vTCrd=vec2(aPos.x,1.-aPos.y);vCrd.zw=vTCrd+((mt*vec3(1)).xy+H.xy)/H.zw;}gl_Position.y*=uFlpY;vSC*=255.;}"};d[$[49]]=function(g){return AGL.Utils[$[41]](g.config[$[45]])+"#define PI radians(180.)\n#define PIH radians(90.)\nin vec2 vTCrd;in vec4 vCrd;in vec4 vCol;in vec4 vDat;in vec4 vExt;in vec4 vS;in float vHS;in float vD;in float vSpt;in float vSC;in vec2 vSln;uniform sampler2D uTex;out vec4 oCl;float clcAng(vec2 a,vec2 b){float c=PIH-atan(a.y,a.x);float d=atan(b.y,b.x);float e=c-PIH;float f=e+(e-d);return abs(f-PIH)/PIH;}void main(void){if(vDat.x<1.)discard;bool isl=vExt.x<1.;vec4 tc=texture(uTex,vTCrd);float alp=tc.a;float shn=tc.b*10.;float ph=tc.g*vSC;vec2 tCrd=vTCrd*vS.xy;vec2 tCnt=vCrd.zw*vS.xy;float pxDst=distance(vec3(tCnt,vHS),vec3(tCrd,ph));float dst=pxDst/vD;if(isl&&dst>1.)discard;if(isl&&vSpt>0.&&vSpt<PI){float slh=(vHS-ph)/255.;vec2 sl=vec2(slh*vSln.y-vCrd.x*vSln.x,slh*vSln.x+vCrd.x*vSln.y);if(atan(sl.x,length(vec2(sl.y,vCrd.y)))+PIH<vSpt)discard;}vec4 lcol=vCol;float vol=1.-(isl?dst:0.);int flg=int(vExt.y);float flatDst=distance(tCnt,tCrd);vec2 dsth=vec2(tCrd.x-tCnt.x,tCrd.y-tCnt.y)/flatDst;float mh=ph-vHS;vec2 p;float pc;if((flg&2)>0&&alp>0.){p=tCrd-dsth;pc=vHS+((flatDst-1.)/flatDst)*mh;tc=texture(uTex,p*vS.zw);float h=tc.g*vSC;if(h>pc)discard;vol*=pow(vol*clcAng(vec2(length(tCrd-p),pc-h),vec2(length(tCnt-p),ph-h)),shn);}if((flg&1)>0&&vol>0.){float lst=max(1.,vExt.w);float hst=(1./flatDst)*mh;float l=flatDst-lst;for(float i=1.;i<flatDst;i+=lst){p=tCnt+i*dsth;pc=vHS+i*hst;tc=texture(uTex,p*vS.zw);if(tc.a>0.){tc.rg*=vSC;if(tc.r<pc&&tc.g>pc)discard;}lst*=1.001;}}oCl=vec4(lcol.rgb*vol*vDat.z,1);}"}});AGL.Stage2D=_[$[0]](AGL[$[73]],function p(q){q=$o.assign({useTint:!0},q||{});q.config=AGL.Utils[$[67]](q.config,AGL.Stage2D);q.config[$[22]]=q.config[$[22]].concat(["aDat","aDst"]);this[$[120]]=new AGL.StageContainer(this);var x=this[$[24]]=Math.max(1,q.maxBatchItems||1e4);this[$[43]]=0;AGL[$[73]].call(this,q);this[$[52]]={};this[$[52]][AGL.Item.TYPE]=_[$[13]];this[$[52]][AGL.Image.TYPE]=this._drawImage.bind(this);this[$[52]][AGL[$[100]].TYPE]=this._drawContainer.bind(this);this[$[142]]=this[$[149]].bind(this);this[$[140]]=AGL.Point.create();this[$[34]]=new AGL.Buffer("aDat",x,3,4);this[$[46]]=new AGL.Buffer("aDst",x,3,4)},function(j,k){_.get(j,"container",function(){return this[$[120]]});j.render=function(){this.picked=$n;k.render.call(this);this[$[156]]=!1};j.setPickerPoint=function(h){this[$[156]]=!0;this[$[140]].x=(h.x-this.widthHalf)*this[$[17]][0];this[$[140]].y=(h.y-this.heightHalf)*this[$[17]][4]};j._render=function(){this._drawItem(this[$[120]]);this[$[149]]()};j._drawItem=function(f){f.update(this[$[44]]);f.callback(f,this[$[44]]);f.renderable&&this[$[52]][f.TYPE](f)};j._drawContainer=function(t){var r=t[$[33]];var l=r.length;for(var i=0;i<l;++i)this._drawItem(r[i])};j._drawImage=function(f){this[$[11]][$[126]](f.blendMode,this[$[142]]);if(this[$[156]]&&f.interactive&&f.isContainsPoint(this[$[140]]))this.picked=f;var m=this[$[43]]*4;var c=this[$[43]]*12;var g=this[$[43]]*16;_[$[39]](this[$[34]].data,f.parent[$[66]],c);_[$[39]](this[$[34]].data,f[$[66]],c+4);this[$[34]].data[c+8]=f.props.alpha;this[$[34]].data[c+9]=f.parent.props.alpha;this[$[34]].data[c+10]=this[$[11]][$[80]](f[$[64]],this[$[44]],!1,this[$[142]]);this[$[34]].data[c+11]=f.tintType;_[$[39]](this[$[42]].data,f[$[17]],g);_[$[39]](this[$[42]].data,f[$[105]],g+6);_[$[39]](this[$[42]].data,f[$[171]],g+12);_[$[39]](this[$[46]].data,f[$[155]],c);_[$[39]](this[$[46]].data,f[$[134]],c+8);++this[$[43]]===this[$[24]]&&this[$[149]]()};j[$[149]]=function(){if(this[$[43]]>0){this[$[15]]();this._gl.uniform1iv(this[$[19]].uTex,this[$[11]][$[117]]);this[$[101]](this[$[43]]);this[$[43]]=0}};j[$[111]]=function(){AGL.Matrix3.projection(this[$[7]],this[$[6]],this[$[120]].parent[$[17]]);++this[$[120]].parent[$[18]]};j[$[15]]=function(){var b=this._gl;var s=this[$[19]];var w=this[$[36]];this[$[34]].upload(b,w,s);this[$[46]].upload(b,w,s);k[$[15]].call(this)};j[$[21]]=function(){k[$[21]].call(this);var b=this._gl;this[$[34]].create(b);this[$[46]].create(b)};j[$[61]]=function(q){var y=q[$[167]];return AGL.Utils[$[41]](q.config[$[45]])+"in vec2 aPos;in mat4 aMt;in mat3x4 aDat;in mat3x4 aDst;uniform float uFlpY;out vec2 vTCrd;out vec4 vTexCrop;out mat2x4 vCol;out float vACol;out float vTexId;out float vTTp;"+(y?"out vec3 vRR;":"")+"vec2 clcQd(mat4x2 mt,vec2 p){vec2 o=1.-p;vec4 cmt=vec4(o.y*mt[0].x+p.y*mt[3].x,o.x*mt[0].y+p.x*mt[1].y,o.y*mt[1].x+p.y*mt[2].x,o.x*mt[3].y+p.x*mt[2].y);return vec2(o.x*cmt.x+p.x*cmt.z,o.y*cmt.y+p.y*cmt.w);}void main(void){mat3 mt=mat3(aMt[0].xy,0,aMt[0].zw,0,aMt[1].xy,1);mat3 tMt=mat3(aMt[1].zw,0,aMt[2].xy,0,aMt[2].zw,1);vec3 pos=vec3(aPos,1);mat4x2 dst=mat4x2(aDst[0],aDst[1]);vec3 tpos=vec3(clcQd(dst,pos.xy),1);gl_Position=vec4(mt*tpos,1);gl_Position.y*=uFlpY;vTCrd=(tMt*pos).xy;vTexCrop=aMt[3];vCol=mat2x4(aDat[0],aDat[1].rgb*aDat[1].a,1.-aDat[1].a);vACol=aDat[2].x*aDat[2].y;vTexId=aDat[2].z;vTTp=aDat[2].w;"+(y?"vRR=aDst[2].xyz;vRR.z=vRR.x+vRR.y;":"")+"}"};j[$[49]]=function(q){var y=q[$[167]];var n=q.useTint;function B(A){var d="vec4 gtTexCol(float i,vec2 c){if(i<0.)return vec4(1);";for(var i=0;i<A;++i)d+="if(i<"+(i+1)+".)return texture(uTex["+i+"],c);";d+="return vec4(0);}";return d};var A=AGL.Utils.info[$[93]];function z(v){return"gtTexCol(vTexId,vTexCrop.xy+vTexCrop.zw*"+v+")"};return AGL.Utils[$[41]](q.config[$[45]])+"in vec2 vTCrd;in vec4 vTexCrop;in mat2x4 vCol;in float vACol;in float vTexId;in float vTTp;"+(y?"in vec3 vRR;":"")+"uniform sampler2D uTex["+A+"];out vec4 oCl;"+B(A)+(y?AGL.Utils.GLSL_RANDOM+"vec4 gtColBCrd(vec2 st,vec2 crd){vec2 tCrd=vTCrd;float rnd=rand(floor(tCrd+st),1.);float rndDg=rnd*360.*vRR.x;if(rndDg>0.){vec2 rt=vec2(sin(rndDg),cos(rndDg));tCrd=vec2(tCrd.x*rt.y-tCrd.y*rt.x,tCrd.x*rt.x+tCrd.y*rt.y);}vec4 cl="+z("mod(tCrd,1.)")+";if(vRR.y>0.)cl.rgb*=1.-(2.*rnd-1.)*vRR.y;cl.rgb*=abs((1.-st.x-crd.x)*(1.-st.y-crd.y));return cl;}":"")+"void main(void){vec2 crd=mod(vTCrd,1.);"+(y?"oCl=vRR.z>0.?(gtColBCrd(vec2(0),crd)+gtColBCrd(vec2(1,0),crd)+gtColBCrd(vec2(0,1),crd)+gtColBCrd(vec2(1),crd))/vec4(1,1,1,4):"+z("crd")+";":"oCl="+z("crd")+";")+"oCl.a*=vACol;if(oCl.a==0.)discard;"+(n?"if(vTTp>0.){vec3 col=vCol[1].rgb+oCl.rgb*vCol[1].a;if(vTTp<2.||(vTTp<3.&&oCl.r==oCl.g&&oCl.r==oCl.b))oCl.rgb*=col;else if(vTTp<4.)oCl.rgb=col;}":"")+"oCl*=vCol[0];}"}});AGL[$[2]]=_[$[0]](_[$[4]],function g(b,d,f){_[$[4]].call(this);this.TYPE=b;this.SUB_TYPE=d;this.on=!0;this.v=new F32A(9);this.kernels=new F32A(9);this.intensity=f},function(c){_[$[1]](c,"intensity",{get:function(){return this.v[0]},set:function(v){this.v[0]=v}});_[$[1]](c,"intensityX",{get:function(){return this.v[0]},set:function(v){this.v[0]=v}});_[$[1]](c,$[146],{get:function(){return this.v[1]},set:function(v){this.v[1]=v}});_[$[1]](c,"r",{get:function(){return this.v[2]},set:function(v){this.v[2]=v}});_[$[1]](c,"g",{get:function(){return this.v[3]},set:function(v){this.v[3]=v}});_[$[1]](c,"b",{get:function(){return this.v[4]},set:function(v){this.v[4]=v}})});AGL.DisplacementFilter=_[$[0]](AGL[$[2]],function f(c,d,x,y){AGL[$[2]].call(this,5,0,d);this[$[64]]=c;this.x=x;this.y=y},function(b){_[$[1]](b,"x",{get:function(){return this.v[1]},set:function(v){this.v[1]=v}});_[$[1]](b,"y",{get:function(){return this.v[2]},set:function(v){this.v[2]=v}})});AGL.MaskFilter=_[$[0]](AGL[$[2]],function f(d,b){AGL[$[2]].call(this,6,0,b);this[$[64]]=d},function(c){_[$[1]](c,"type",{get:function(){return this.v[0]},set:function(v){this.v[0]=v}})});AGL.MaskFilter.Type=_[$[79]]({RED:0,GREEN:1,BLUE:2,ALPHA:3,AVG:4});AGL.PixelateFilter=_[$[0]](AGL[$[2]],function c(b){AGL[$[2]].call(this,4,0,b)});AGL.EdgeDetectFilter=_[$[0]](AGL[$[2]],function c(b){AGL[$[2]].call(this,1,0,b);_[$[39]](this.kernels,[-1,-1,-1,-1,8,-1,-1,-1,-1],0)});AGL.SharpenFilter=_[$[0]](AGL[$[2]],function c(b){AGL[$[2]].call(this,1,0,b);_[$[39]](this.kernels,[-1,-1,-1,-1,16,-1,-1,-1,-1],0)});AGL.GrayscaleFilter=_[$[0]](AGL[$[2]],function b(){AGL[$[2]].call(this,2,1)});AGL.SepiaFilter=_[$[0]](AGL[$[2]],function b(){AGL[$[2]].call(this,2,2)});AGL.InvertFilter=_[$[0]](AGL[$[2]],function b(){AGL[$[2]].call(this,2,3)});AGL.TintFilter=_[$[0]](AGL[$[2]],function d(c,r,g,b){AGL[$[2]].call(this,2,4,c);this.r=r;this.g=g;this.b=b});AGL.ColorLimitFilter=_[$[0]](AGL[$[2]],function c(b){AGL[$[2]].call(this,2,5,b)});AGL.VignetteFilter=_[$[0]](AGL[$[2]],function j(d,f,h,r,g,b){AGL[$[2]].call(this,2,6,d);this.roundness=f;this.transition=h;this.r=r;this.g=g;this.b=b},function(c){_[$[1]](c,"roundness",{get:function(){return this.v[1]},set:function(v){this.v[1]=v}});_[$[1]](c,"transition",{get:function(){return 1/this.v[5]},set:function(v){this.v[5]=1/v}})});AGL.RainbowFilter=_[$[0]](AGL[$[2]],function b(){AGL[$[2]].call(this,2,7)});AGL.BrightnessContrastFilter=_[$[0]](AGL[$[2]],function f(d,c){AGL[$[2]].call(this,2,8,d);this.contrast=c},function(b){_[$[1]](b,"brightness",{get:function(){return this.v[0]},set:function(v){this.v[0]=v}});_[$[1]](b,"contrast",{get:function(){return this.v[1]},set:function(v){this.v[1]=v}})});AGL.GammaFilter=_[$[0]](AGL[$[2]],function c(b){AGL[$[2]].call(this,2,9,b)});AGL.BlurFilter=_[$[0]](AGL[$[2]],function b(c,d){AGL[$[2]].call(this,3,1,c);this[$[146]]=d});AGL.GlowFilter=_[$[0]](AGL[$[2]],function d(f,g,b){AGL[$[2]].call(this,3,2,f);this[$[146]]=g;this.volume=b},function(c){_[$[1]](c,"volume",{get:function(){return this.v[3]},set:function(v){this.v[3]=v}})});}).call({});