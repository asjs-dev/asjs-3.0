(function(){trc("AGL (ASJS WebGl) 1.0");_w.AGL={};c3(AGL,"Matrix3");AGL.Matrix3.isPointInMatrix=function(vec,pm,cm,mdst,invDst){mdst[0]=pm[0]*cm[0]+pm[3]*cm[1];mdst[1]=pm[1]*cm[0]+pm[4]*cm[1];mdst[2]=pm[0]*cm[3]+pm[3]*cm[4];mdst[3]=pm[1]*cm[3]+pm[4]*cm[4];mdst[4]=pm[0]*cm[6]+pm[3]*cm[7]+pm[6];mdst[5]=pm[1]*cm[6]+pm[4]*cm[7]+pm[7];var d=1/(mdst[0]*mdst[3]-mdst[2]*mdst[1]);invDst[0]=d*mdst[3];invDst[1]=-d*mdst[1];invDst[2]=-d*mdst[2];invDst[3]=d*mdst[0];invDst[4]=d*(mdst[2]*mdst[5]-mdst[3]*mdst[4]);invDst[5]=-d*(mdst[0]*mdst[5]-mdst[1]*mdst[4]);var x=vec[0]*invDst[0]+vec[1]*invDst[2]+invDst[4];var y=vec[0]*invDst[1]+vec[1]*invDst[3]+invDst[5];return x>=0&&y>=0&&x<=1&&y<=1};AGL.Matrix3.identity=function(){return new Float32Array([1,0,0,0,1,0,0,0,1,])};AGL.Matrix3.projection=function(width,height,dst){dst[0]=2/width;dst[1]=0;dst[2]=0;dst[3]=0;dst[4]=-2/height;dst[5]=0;dst[6]=-1;dst[7]=1;dst[8]=1};AGL.Matrix3.transformLocal=function(x,y,sr,cr,ax,ay,sx,sy,dst){dst[0]=cr*sx;dst[1]=sr*sx;dst[3]=-sr*sy;dst[4]=cr*sy;dst[6]=x-(ax*dst[0])-(ay*dst[3]);dst[7]=y-(ax*dst[1])-(ay*dst[4])};AGL.Matrix3.transform=function(m,x,y,sr,cr,ax,ay,sx,sy,dst){dst[0]=(cr*m[0])+(sr*m[3]);dst[1]=(cr*m[1])+(sr*m[4]);dst[3]=(cr*m[3])-(sr*m[0]);dst[4]=(cr*m[4])-(sr*m[1]);dst[6]=-(ax*dst[0])-(ay*dst[3])+(x*m[0])+(y*m[3])+m[6];dst[7]=-(ax*dst[1])-(ay*dst[4])+(x*m[1])+(y*m[4])+m[7];dst[0]*=sx;dst[1]*=sx;dst[3]*=sy;dst[4]*=sy};cnst(AGL.Matrix3,"IDENTITY",AGL.Matrix3.identity());c1(AGL,"Utils",ASJS.BaseClass,function(j){j.info={};j.new=x;function x(){j.info.isWebGl2Supported=_fls;map(["webgl2"],function(a,d){var k=_d.createElement("canvas");var b;if(b=k.getContext(d)){j.info.isWebGl2Supported=_tru;j.info.maxTextureImageUnits=b.getParameter(b.MAX_TEXTURE_IMAGE_UNITS);j.info.maxTextureSize=b.getParameter(b.MAX_TEXTURE_SIZE);j.info.maxVertexAttributes=b.getParameter(b.MAX_VERTEX_ATTRIBS);j.info.maxVaryingVectors=b.getParameter(b.MAX_VARYING_VECTORS);j.info.maxVertexUniformVectors=b.getParameter(b.MAX_VERTEX_UNIFORM_VECTORS);j.info.maxFragmentUniformComponents=b.getParameter(b.MAX_FRAGMENT_UNIFORM_COMPONENTS);j.info.maxFragmentUniformVectors=b.getParameter(b.MAX_FRAGMENT_UNIFORM_VECTORS);j.info.maxVaryingComponents=b.getParameter(b.MAX_VARYING_COMPONENTS)}})};j.useTexture=function(b,f,u){b.activeTexture(b.TEXTURE0+f);b.bindTexture(u.target,u.texture);b.texImage2D(u.target,0,b.RGBA,u.width,u.height,0,b.RGBA,b.UNSIGNED_BYTE,u.source);b.texParameteri(u.target,b.TEXTURE_MAX_LEVEL,u.maxLevel);var y=r(u.width)&&r(u.height);if(y){b.generateMipmap(u.target);b.flush()};b.texParameteri(u.target,b.TEXTURE_WRAP_S,u.wrapS);b.texParameteri(u.target,b.TEXTURE_WRAP_T,u.wrapT);if(y){b.texParameteri(u.target,b.TEXTURE_MIN_FILTER,u.minFilter===b.LINEAR?b.LINEAR_MIPMAP_LINEAR:b.NEAREST_MIPMAP_NEAREST)}else{b.texParameteri(u.target,b.TEXTURE_MIN_FILTER,u.minFilter)};b.texParameteri(u.target,b.TEXTURE_MIN_FILTER,u.minFilter);b.texParameteri(u.target,b.TEXTURE_MAG_FILTER,u.magFilter)};j.loadShader=function(b,s,v){var g=b.createShader(b[s]);b.shaderSource(g,v);b.compileShader(g);var o=b.getShaderParameter(g,b.COMPILE_STATUS);if(!o){var p=b.getShaderInfoLog(g);trc("Error compiling shader "+s+":"+p);b.deleteShader(g);return null};return g};j.createProgram=function(b,m,t,w){var n=b.createProgram();map(m,function(c,g){b.attachShader(n,g)});if(t){map(t,function(c,i){b.bindAttribLocation(n,w?w[c]:c,i)})};b.linkProgram(n);var h=b.getProgramParameter(n,b.LINK_STATUS);if(!h){var p=b.getProgramInfoLog(n);trc("Error in program linking:"+p);b.deleteProgram(n);return null};b.flush();return n};j.getLocationsFor=function(b,n,A){var q={};map(A,function(c,z){q[c]=b[z](n,c)});return q};j.destroyTexture=function(b,l){b.bindTexture(l.target,null);b.deleteTexture(l.texture)};function r(e){return(e&(e-1))==0}});AGL.Utils.ShaderType={"VERTEX_SHADER":"VERTEX_SHADER","FRAGMENT_SHADER":"FRAGMENT_SHADER"};c0(AGL,"Bitmap",ASJS.DisplayObject,function(b,c){b.clearColor=new AGL.ColorProps();var a;ASJS.CanvasApi.initBaseCanvas(b,c);ovrd(b,c,"new");b.new=function(f,g,d){c.new("canvas");var h={alpha:(d&&d.alpha)||_fls,antialias:(d&&d.antialias)||_fls,depth:(d&&d.depth)||_fls,stencil:(d&&d.stencil)||_fls,premultipliedAlpha:(d&&d.premultipliedAlpha)||_fls,powerPreference:(d&&d.powerPreference)||'high-performance'};c.prot.contextAttributes=h;c.prot.contextType="webgl2";b.setBitmapSize(f,g);a=b.getContext();a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_tru);a.enable(a.BLEND)};b.clearRect=function(){var e=b.clearColor;e.isUpdated()&&a.clearColor(e.r,e.g,e.b,e.a);a.clear(a.COLOR_BUFFER_BIT)};ovrd(b,c,"destruct");b.destruct=function(){b.clearColor=a=null;b.destructBaseCanvasApi();c.destruct()};b.update=function(){a&&a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight);b[de](AGL.Bitmap.RESIZE)}});msg(AGL.Bitmap,"RESIZE");c3(AGL,"Config");rof(AGL.Config,"create",function(b){if(b.textureNum===undefined||b.textureNum>AGL.Utils.instance.info.maxTextureImageUnits){console.warn("Maximum of texture units is "+16);b.textureNum=AGL.Utils.instance.info.maxTextureImageUnits};if(b.lightsNum===undefined)b.lightsNum=0;else if(b.lightsNum>16){console.warn("Maximum of lights is "+16);b.lightsNum=16};var a={"textureNum":b.textureNum,"lightsNum":b.lightsNum,"isLightEnabled":b.lightsNum>0,"isMaskEnabled":b.isMaskEnabled,"filters":b.filters,"isFilterEnabled":b.filters&&b.filters.length>0};Object.freeze(a);return a});c3(AGL,"BlendModes");AGL.BlendModes.NORMAL=["SRC_ALPHA","ONE_MINUS_SRC_ALPHA","ONE","ONE_MINUS_SRC_ALPHA"];AGL.BlendModes.ADD=["SRC_ALPHA","DST_ALPHA","ONE","DST_ALPHA"];AGL.BlendModes.MULTIPLY=["DST_COLOR","ONE_MINUS_SRC_ALPHA"];AGL.BlendModes.SCREEN=["SRC_ALPHA","ONE_MINUS_SRC_COLOR","ONE","ONE_MINUS_SRC_COLOR"];AGL.BlendModes.OVERLAY=["ONE","ONE_MINUS_SRC_ALPHA"];AGL.AbstractProps=c4(ASJS.BasePrototypeClass,function b(){this.id=-1;this._currentId=-1},function(){this.isUpdated=function(){var a=this._currentId!==this.id;this._currentId=this.id;return a}});AGL.ColorProps=c4(AGL.AbstractProps,function a(){AGL.AbstractProps.call(this);this.items=[1,1,1,1]},function(){prop(this,"r",{get:function(){return this.items[0]},set:function(v){if(this.items[0]!==v){this.items[0]=v;++this.id}}});prop(this,"g",{get:function(){return this.items[1]},set:function(v){if(this.items[1]!==v){this.items[1]=v;++this.id}}});prop(this,"b",{get:function(){return this.items[2]},set:function(v){if(this.items[2]!==v){this.items[2]=v;++this.id}}});prop(this,"a",{get:function(){return this.items[3]},set:function(v){if(this.items[3]!==v){this.items[3]=v;++this.id}}})});AGL.ItemProps=c4(AGL.AbstractProps,function a(){AGL.AbstractProps.call(this);this._sr=0;this._cr=1;this._x=0;this._y=0;this._zIndex=0;this._rotation=0;this._scaleX=1;this._scaleY=1;this._width=1;this._height=1;this._anchorX=0;this._anchorY=0;this._scaledWidth=1;this._scaledHeight=1},function(){get(this,"sr",function(){return this._sr});get(this,"cr",function(){return this._cr});get(this,"scaledWidth",function(){return this._scaledWidth});get(this,"scaledHeight",function(){return this._scaledHeight});prop(this,"x",{get:function(){return this._x},set:function(v){if(this._x!==v){this._x=v;++this.id}}});prop(this,"y",{get:function(){return this._y},set:function(v){if(this._y!==v){this._y=v;++this.id}}});prop(this,"zIndex",{get:function(){return this._zIndex},set:function(v){this._zIndex!==v&&(this._zIndex=v)}});prop(this,"rotation",{get:function(){return this._rotation},set:function(v){if(this._rotation!==v){this._rotation=v;this._sr=_m.sin(this._rotation);this._cr=_m.cos(this._rotation);++this.id}}});prop(this,"scaleX",{get:function(){return this._scaleX},set:function(v){if(this._scaleX!==v){this._scaleX=v;this._updateScaledWidth();++this.id}}});prop(this,"scaleY",{get:function(){return this._scaleY},set:function(v){if(this._scaleY!==v){this._scaleY=v;this._updateScaledHeight();++this.id}}});prop(this,"width",{get:function(){return this._width},set:function(v){if(this._width!==v){this._width=v;this._updateScaledWidth();++this.id}}});prop(this,"height",{get:function(){return this._height},set:function(v){if(this._height!==v){this._height=v;this._updateScaledHeight();++this.id}}});prop(this,"anchorX",{get:function(){return this._anchorX},set:function(v){if(this._anchorX!==v){this._anchorX=v;++this.id}}});prop(this,"anchorY",{get:function(){return this._anchorY},set:function(v){if(this._anchorY!==v){this._anchorY=v;++this.id}}});this._updateScaledWidth=function(){this._scaledWidth=this._width*this._scaleX};this._updateScaledHeight=function(){this._scaledHeight=this._height*this._scaleY}});AGL.LightEffectProps=c4(AGL.AbstractProps,function a(){AGL.AbstractProps.call(this);this.items=[0,0,2,2]},function(){prop(this,"anchorX",{get:function(){return this.items[0]},set:function(v){if(this.items[0]!==v){this.items[0]=v;++this.id}}});prop(this,"anchorY",{get:function(){return this.items[1]},set:function(v){if(this.items[1]!==v){this.items[1]=v;++this.id}}});prop(this,"quadX",{get:function(){return this.items[2]},set:function(v){if(this.items[2]!==v){this.items[2]=v;++this.id}}});prop(this,"quadY",{get:function(){return this.items[3]},set:function(v){if(this.items[3]!==v){this.items[3]=v;++this.id}}})});AGL.TextureCrop=c4(AGL.AbstractProps,function a(){AGL.AbstractProps.call(this);this.items=[0,0,1,1]},function(){prop(this,"x",{get:function(){return this.items[0]},set:function(v){if(this.items[0]!==v){this.items[0]=v;++this.id}}});prop(this,"y",{get:function(){return this.items[1]},set:function(v){if(this.items[1]!==v){this.items[1]=v;++this.id}}});prop(this,"width",{get:function(){return this.items[2]},set:function(v){if(this.items[2]!==v){this.items[2]=v;++this.id}}});prop(this,"height",{get:function(){return this.items[3]},set:function(v){if(this.items[3]!==v){this.items[3]=v;++this.id}}})});AGL.TextureProps=c4(AGL.AbstractProps,function a(){AGL.AbstractProps.call(this);this._sr=0;this._cr=1;this._x=0;this._y=0;this._rotation=0;this._width=1;this._height=1;this._anchorX=0;this._anchorY=0},function(){get(this,"sr",function(){return this._sr});get(this,"cr",function(){return this._cr});prop(this,"x",{get:function(){return this._x},set:function(v){if(this._x!==v){this._x=v;++this.id}}});prop(this,"y",{get:function(){return this._y},set:function(v){if(this._y!==v){this._y=v;++this.id}}});prop(this,"rotation",{get:function(){return this._rotation},set:function(v){if(this._rotation!==v){this._rotation=v;this._sr=_m.sin(this._rotation);this._cr=_m.cos(this._rotation);++this.id}}});prop(this,"width",{get:function(){return this._width},set:function(v){if(this._width!==v){this._width=v;++this.id}}});prop(this,"height",{get:function(){return this._height},set:function(v){if(this._height!==v){this._height=v;++this.id}}});prop(this,"anchorX",{get:function(){return this._anchorX},set:function(v){if(this._anchorX!==v){this._anchorX=v;++this.id}}});prop(this,"anchorY",{get:function(){return this._anchorY},set:function(v){if(this._anchorY!==v){this._anchorY=v;++this.id}}})});AGL.Texture=c4(ASJS.BasePrototypeClass,function g(a,e){this._wglUtils=AGL.Utils.instance;this._source;this._onTextureLoadedBind=this._onTextureLoaded.bind(this);this.asjsEl;this.loaded=_fls;this.isVideo=_fls;this.shouldUpdate=_fls;this.texture=a.createTexture();this.maxLevel=10;this.target=a.TEXTURE_2D;this.wrapS=a.CLAMP_TO_EDGE;this.wrapT=a.CLAMP_TO_EDGE;this.minFilter=a.NEAREST;this.magFilter=a.NEAREST;this.source=e;this._sourceWidthPropName="width";this._sourceHeightPropName="height";this._currentRenderId=-1},function(f){get(this,"width",function(){return this._source[this._sourceWidthPropName]});get(this,"height",function(){return this._source[this._sourceHeightPropName]});prop(this,"source",{get:function(){return this._source},set:function(v){this.asjsEl&&this.asjsEl[off](this.isVideo?ASJS.MediaEvent.CAN_PLAY:ASJS.LoaderEvent.LOAD,this._onTextureLoadedBind);this.asjsEl=v;this._source=this.asjsEl.el;this.isVideo=this._source.tagName.toLowerCase()==="video";this._parseTextureSize();this.asjsEl[on](this.isVideo?ASJS.MediaEvent.CAN_PLAY:ASJS.LoaderEvent.LOAD,this._onTextureLoadedBind)}});this.autoUpdate=function(h){var i=h!==this._currentRenderId;this._currentRenderId=h;return i&&(this.shouldUpdate||(this.isVideo&&!this.asjsEl.paused))};this.destruct=function(){this.asjsEl[off](ASJS.LoaderEvent.LOAD,this._onTextureLoadedBind);this.asjsEl[off](this.isVideo?ASJS.MediaEvent.CAN_PLAY:ASJS.LoaderEvent.LOAD,this._onTextureLoadedBind);f.destruct.call(this)};this._parseTextureSize=function(){this._sourceWidthPropName="naturalWidth";this._sourceHeightPropName="naturalHeight";if(!this._source[this._sourceWidthPropName]){this._sourceWidthPropName="videoWidth";this._sourceHeightPropName="videoHeight"};if(!this._source[this._sourceWidthPropName]){this._sourceWidthPropName="width";this._sourceHeightPropName="height"};this.loaded=this.width>0&&this.height>0};this._onTextureLoaded=this._parseTextureSize});rof(AGL.Texture,"loadImage",function(a,b){var c=new ASJS.Image();c.src=b;return new AGL.Texture(a,c)});rof(AGL.Texture,"loadVideo",function(a,b){var d=new ASJS.VideoPlayer();d.src=b;return new AGL.Texture(a,d)});AGL.Item=c4(ASJS.BasePrototypeClass,function a(){cnst(this,"type","item");this.renderable=_tru;this.interactive=_fls;this.matrixCache=AGL.Matrix3.identity();this.props=new AGL.ItemProps();this.color=new AGL.ColorProps();this.colorCache=this.color.items;this.parent=null},function(c){get(this,"stage",function(){return this.parent?this.parent.stage:null});this.destruct=function(){this.parent&&this.parent.removeChild&&this.parent.removeChild(this);c.destruct.call(this)};this.update=function(e,d){this._updateProps(d)};this._updateProps=function(d){var b=this.props;b.isUpdated()&&this._transformItem(b,d)};this._transformItem=function(b,d){AGL.Matrix3.transform(d.matrixCache,b.x,b.y,b.sr,b.cr,b.anchorX,b.anchorY,b.scaledWidth,b.scaledHeight,this.matrixCache)}});cnst(AGL.Item,"TYPE","item");AGL.Light=c4(AGL.Item,function a(){AGL.Item.call(this);this._currentWorldPropsUpdateId=-1;this.positionCache=[];this.volumeCache=[];this.effect=new AGL.LightEffectProps();this.effectCache=this.effect.items;this.color.a=0},function(){this._updateProps=function(c){var b=this.props;if(this._currentWorldPropsUpdateId!==c.worldPropsUpdateId||b.isUpdated()){this._currentWorldPropsUpdateId=c.worldPropsUpdateId;this._transformItem(b,c);this.positionCache[0]=this.matrixCache[6];this.positionCache[1]=this.matrixCache[7];this.volumeCache[0]=1/_m.abs(this.matrixCache[0]);this.volumeCache[1]=1/_m.abs(this.matrixCache[4])}}});AGL.Image=c4(AGL.Item,function a(d){AGL.Item.call(this);cnst(this,"type","drawable");this.textureMatrixCache=AGL.Matrix3.identity();this.mask=null;this.tintType=AGL.Image.Tint.NORMAL;this.blendMode=AGL.BlendModes.NORMAL;this.textureProps=new AGL.TextureProps();this.textureCrop=new AGL.TextureCrop();this.textureCropCache=this.textureCrop.items;this.texture=d},function(){this.update=function(){this._updateProps();this._updateTextureProps()};this._updateProps=function(){var b=this.props;b.isUpdated()&&this._transformItem(b,this.matrixCache)};this._updateTextureProps=function(){var e=this.textureProps;e.isUpdated()&&this._transformItem(e,this.textureMatrixCache)};this._transformItem=function(b,c){AGL.Matrix3.transformLocal(b.x,b.y,b.sr,b.cr,b.anchorX,b.anchorY,b.scaledWidth,b.scaledHeight,c)}});cnst(AGL.Image,"TYPE","drawable");cnst(AGL.Image,"Tint",{"NORMAL":0,"GRAYSCALE":1,"OVERRIDE":2,});AGL.AnimatedImage=c4(AGL.Image,function g(c){AGL.Image.call(this,c);this.frameLength=120;this.frame=0;this.frames=[];this.isPlaying=_fls;this._latestUpdate=-1},function(b){this.gotoAndStop=function(a){this.frame=a};this.gotoAndPlay=function(a){this.frame=a;this.play()};this.stop=function(){this.isPlaying=_fls};this.play=function(){this.isPlaying=_tru};this.update=function(d){this.updateAnimation(d);b.update.call(this)};this.updateAnimation=function(d){if(this.isPlaying){var f=d-this._latestUpdate;if(f>=this.frameLength){this._latestUpdate=d;this.frame+=_m.floor(f/this.frameLength);this.frame>=this.frames.length&&(this.frame=0);var h=this.frames[this.frame];var e=this.textureCrop;e.x=h.x;e.y=h.y;e.width=h.width;e.height=h.height}}};this.destruct=function(){this.stop();b.destruct.call(this)}});AGL.Container=c4(AGL.Item,function h(){AGL.Item.call(this);cnst(this,"type","container");this._currentWorldPropsUpdateId=-1;this._currentWorldColorUpdateId=-1;this._children=[];this.worldPropsUpdateId=this.worldColorUpdateId=0;this.colorCache=[1,1,1,1]},function(){get(this,"children",function(){return this._children});get(this,"numChildren",function(){return this._children.length});this.clear=function(){while(this.numChildren)this.removeChildAt(0)};this.contains=function(a){return this.getChildIndex(a)>-1};this.addChild=function(a){return this.addChildAt(a,this.numChildren)};this.addChildAt=function(a,b){if(!a)return null;if(a.parent)a.parent.removeChild(a);this._children.push(a);this.setChildIndex(a,b);a.parent=this;return a};this.removeChild=function(a){if(!a||!this.contains(a))return null;_children.remove(a);a.parent=null;return a};this.removeChildAt=function(b){return this.removeChild(this.getChildAt(b))};this.getChildAt=function(b){return this._children[b]};this.setChildIndex=function(a,b){if(!a||b<0)return null;this._children.remove(a);this._children.splice(b,0,a);return a};this.getChildIndex=function(a){return this._children.indexOf(a)};this.swapChildren=function(e,f){var j=this.getChildIndex(e);var k=this.getChildIndex(f);if(j===-1||k===-1)return _fls;this.setChildIndex(e,k);this.setChildIndex(f,j);return _tru};this.update=function(i,g){this._updateProps(g);this._updateColor(g)};this._updateProps=function(g){var c=this.props;if(this._currentWorldPropsUpdateId!==g.worldPropsUpdateId||c.isUpdated()){this._currentWorldPropsUpdateId=g.worldPropsUpdateId;this.worldPropsUpdateId++;this._transformItem(c,g)}};this._updateColor=function(g){var d=this.color;if(this._currentWorldColorUpdateId!==g.worldColorUpdateId||d.isUpdated()){this._currentWorldColorUpdateId=g.worldColorUpdateId;this.worldColorUpdateId++;var l=g.colorCache;this.colorCache[0]=l[0]*d.r;this.colorCache[1]=l[1]*d.g;this.colorCache[2]=l[2]*d.b;this.colorCache[3]=l[3]*d.a}}});cnst(AGL.Container,"TYPE","container");AGL.BaseRenderer=c4(AGL.Container,function A(x,B,D,v,o){AGL.Container.call(this);this._webGlUtils=AGL.Utils.instance;this._MAX_BATCH_ITEMS=10000;this._renderId=0;this._latestBlendMode=AGL.BlendModes.NORMAL;this._batchItems=0;this._textureMap=[];this._textureIds=[];this._textureIdBufferUpdated=_fls;this._shouldResize=_tru;this._config=o;this._onResizeBind=this._onResize.bind(this);this._webGlBitmap=x;this._webGlBitmap[on](AGL.Bitmap.RESIZE,this._onResizeBind);this._gl=this._webGlBitmap.getContext();var r=this._webGlUtils.createProgram(this._gl,[this._webGlUtils.loadShader(this._gl,AGL.Utils.ShaderType.VERTEX_SHADER,B(this._config)),this._webGlUtils.loadShader(this._gl,AGL.Utils.ShaderType.FRAGMENT_SHADER,D(this._config))]);this._locations=this._webGlUtils.getLocationsFor(this._gl,r,v||{"a_position":"getAttribLocation","a_matrix":"getAttribLocation","a_worldMatrix":"getAttribLocation","a_texMatrix":"getAttribLocation","a_texCrop":"getAttribLocation","u_tex":"getUniformLocation",});this._gl.useProgram(r);this._setBlendMode();var C=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,C);this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array([0.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0]),this._gl.STATIC_DRAW);this._gl.vertexAttribPointer(this._locations["a_position"],2,this._gl.FLOAT,_fls,0,0);this._gl.enableVertexAttribArray(this._locations["a_position"]);var y=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,y);this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),this._gl.STATIC_DRAW);this._matrixData=new Float32Array(this._MAX_BATCH_ITEMS*9);this._matrixBuffer=this._createArrayBuffer(this._matrixData,"a_matrix",9,3,3,this._gl.FLOAT,4);this._worldMatrixData=new Float32Array(this._MAX_BATCH_ITEMS*9);this._worldMatrixBuffer=this._createArrayBuffer(this._matrixData,"a_worldMatrix",9,3,3,this._gl.FLOAT,4);this._textureMatrixData=new Float32Array(this._MAX_BATCH_ITEMS*9);this._textureMatrixBuffer=this._createArrayBuffer(this._textureMatrixData,"a_texMatrix",9,3,3,this._gl.FLOAT,4);this._textureCropData=new Float32Array(this._MAX_BATCH_ITEMS*4);this._textureCropBuffer=this._createArrayBuffer(this._textureCropData,"a_texCrop",4,1,4,this._gl.FLOAT,4);this._drawFunctionMap={};this._drawFunctionMap["item"]=emptyFunction;this._drawFunctionMap["drawable"]=this._drawImage.bind(this);this._drawFunctionMap["container"]=this._drawContainer.bind(this);this._update=this._updateProps=emptyFunction;this._resize()},function(q){get(this,"bitmap",function(){return this._webGlBitmap});get(this,"stage",function(){return this});this.render=function(){this._resize();this._render()};this.destruct=function(){this._webGlBitmap[off](AGL.Bitmap.RESIZE,this._onResizeBind);q.destruct.call(this)};this._render=function(){this._webGlBitmap.clearRect();this._renderTimer=Date.now();this._drawContainer(this);this._batchItems>0&&this._batchDraw();++this._renderId};this._drawItem=function(c,k){if(!c.renderable)return;c.update(this._renderTimer,k);c.type!=="item"&&this._drawFunctionMap[c.type](c,k)};this._drawContainer=function(u){var s=u.children;var i;var l;for(i=0,l=s.length;i<l;++i){this._drawItem(s[i],u)}};this._checkBlendMode=function(c){if(this._latestBlendMode!==c.blendMode){this._batchDraw();this._latestBlendMode=c.blendMode;this._setBlendMode()}};this._setBufferData=function(c,k,F,h,j){arraySet(this._worldMatrixData,k.matrixCache,h);arraySet(this._matrixData,c.matrixCache,h);arraySet(this._textureMatrixData,c.textureMatrixCache,h);arraySet(this._textureCropData,c.textureCropCache,j)};this._drawImage=function(c,k){this._checkBlendMode(c);var F=this._drawTexture(c.texture);this._setBufferData(c,k,F,this._batchItems*9,this._batchItems*4);++this._batchItems===this._MAX_BATCH_ITEMS&&this._batchDraw()};this._createArrayBuffer=function(d,w,m,b,f,e,g){var n=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ARRAY_BUFFER,n);this._gl.bufferData(this._gl.ARRAY_BUFFER,d.byteLength,this._gl.DYNAMIC_DRAW);this._attachArrayBuffer(this._locations[w],n,d,m,b,f,e,g);return n};this._attachArrayBuffer=function(t,n,d,m,b,f,e,g){this._bindArrayBuffer(n,d);var p=g*m;var i=b+1;while(--i){var a=t+(b-i);this._gl.enableVertexAttribArray(a);this._gl[e===this._gl.FLOAT?"vertexAttribPointer":"vertexAttribIPointer"](a,f,e,_fls,p,(b-i)*g*f);this._gl.vertexAttribDivisor(a,1)}};this._bindArrayBuffer=function(n,d){this._gl.bindBuffer(this._gl.ARRAY_BUFFER,n);this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,d)};this._bindBuffers=function(){this._bindArrayBuffer(this._matrixBuffer,this._matrixData);this._bindArrayBuffer(this._worldMatrixBuffer,this._worldMatrixData);this._bindArrayBuffer(this._textureMatrixBuffer,this._textureMatrixData);this._bindArrayBuffer(this._textureCropBuffer,this._textureCropData)};this._batchDraw=function(){if(this._textureIdBufferUpdated){this._textureIdBufferUpdated=_fls;var E=new Uint16Array(this._textureIds);this._gl.uniform1iv(this._locations["u_tex"],E)};this._bindBuffers();this._gl.drawElementsInstanced(this._gl.TRIANGLE_FAN,6,this._gl.UNSIGNED_SHORT,0,this._batchItems);this._batchItems=0};this._drawTexture=function(z){if(!z.loaded)return 0;var F=this._textureMap.indexOf(z);if(F===-1||z.autoUpdate(this._renderId)){if(F===-1){if(this._textureMap.length===this._config.textureNum){this._batchDraw();this._textureIds.length=this._textureMap.length=0};this._textureMap.push(z);F=this._textureMap.length-1;this._textureIds.push(F);this._textureIdBufferUpdated=_tru};this._webGlUtils.useTexture(this._gl,F,z)};return F+1};this._setBlendMode=function(){this._latestBlendMode.length===4?this._gl.blendFuncSeparate(this._gl[this._latestBlendMode[0]],this._gl[this._latestBlendMode[1]],this._gl[this._latestBlendMode[2]],this._gl[this._latestBlendMode[3]]):this._gl.blendFunc(this._gl[this._latestBlendMode[0]],this._gl[this._latestBlendMode[1]])};this._resize=function(){if(!this._shouldResize)return _fls;this._shouldResize=_fls;this._width=this._webGlBitmap.bitmapWidth;this._height=this._webGlBitmap.bitmapHeight;this._widthHalf=this._width*0.5;this._heightHalf=this._height*0.5;AGL.Matrix3.projection(this._width,this._height,this.matrixCache);this.worldPropsUpdateId++;return _tru};this._onResize=function(){this._shouldResize=_tru}});rof(AGL.BaseRenderer,"createVertexShader",function(){return"#version 300 es\nin vec2 a_position;in mat3 a_matrix;in mat3 a_worldMatrix;in mat3 a_texMatrix;in vec4 a_texCrop;out vec2 v_texCoord;out vec2 v_texCrop;out vec2 v_texCropSize;void main(void){vec3 pos=vec3(a_position,1.0);gl_Position=vec4((a_worldMatrix*a_matrix*pos).xy,0.0,1.0);v_texCoord=(a_texMatrix*pos).xy;v_texCrop=a_texCrop.xy;v_texCropSize=a_texCrop.zw-a_texCrop.xy;}"});rof(AGL.BaseRenderer,"createFragmentShader",function(){return"#version 300 es\nprecision lowp float;in vec2 v_texCoord;in vec2 v_texCrop;in vec2 v_texCropSize;out vec4 fragColor;void main(void){fragColor=vec4(1.0,0.0,1.0,1.0);}"});AGL.SimpleRenderer=c4(AGL.BaseRenderer,function k(h,j,l,c){AGL.BaseRenderer.call(this,h,j,l,{"a_position":"getAttribLocation","a_matrix":"getAttribLocation","a_worldMatrix":"getAttribLocation","a_texMatrix":"getAttribLocation","a_texCrop":"getAttribLocation","a_texId":"getAttribLocation","u_tex":"getUniformLocation",},c);this._texIdData=new Float32Array(this._MAX_BATCH_ITEMS);this._texIdBuffer=this._createArrayBuffer(this._texIdData,"a_texId",1,1,1,this._gl.FLOAT,4)},function(d){this._setBufferData=function(a,e,m,b,f){d._setBufferData.call(this,a,e,m,b,f);this._texIdData[this._batchItems]=m};this._bindBuffers=function(){d._bindBuffers.call(this);this._bindArrayBuffer(this._texIdBuffer,this._texIdData)}});rof(AGL.SimpleRenderer,"createVertexShader",function(){var g="#version 300 es\nin vec2 a_position;in mat3 a_matrix;in mat3 a_worldMatrix;in mat3 a_texMatrix;in vec4 a_texCrop;in float a_texId;out vec2 v_texCoord;out vec2 v_texCrop;out vec2 v_texCropSize;out float v_texId;void main(void){vec3 pos=vec3(a_position,1.0);gl_Position=vec4((a_worldMatrix*a_matrix*pos).xy,0.0,1.0);v_texCoord=(a_texMatrix*pos).xy;v_texCrop=a_texCrop.xy;v_texCropSize=a_texCrop.zw-a_texCrop.xy;v_texId=a_texId;}";return g});rof(AGL.SimpleRenderer,"createFragmentShader",function(c){var n=c.textureNum;var g="#version 300 es\n#define MAX_TEXTURES "+n+"\nprecision lowp float;in vec2 v_texCoord;in vec2 v_texCrop;in vec2 v_texCropSize;in float v_texId;uniform sampler2D u_tex[MAX_TEXTURES];out vec4 fragColor;";g+="void main(void){";for(var i=-1;i<n;i++){g+=(i>-1?" else ":"")+"if(v_texId<"+(i+1)+".5){";g+="fragColor="+(i<0?"vec4(0.0,0.0,0.0,0.0);":"texture(u_tex["+i+"],v_texCrop+v_texCropSize*fract(v_texCoord));");g+="}"};g+="}";return g});AGL.MaskRenderer=c4(AGL.SimpleRenderer,function d(c,e,f,b){AGL.SimpleRenderer.call(this,c,e,f,b);c.clearColor.r=c.clearColor.g=c.clearColor.b=c.clearColor.a=0},function(){});rof(AGL.MaskRenderer,"createVertexShader",AGL.SimpleRenderer.createVertexShader);rof(AGL.MaskRenderer,"createFragmentShader",function(b){var g=b.textureNum;var a="#version 300 es\n#define MAX_TEXTURES "+g+"\nprecision lowp float;in vec2 v_texCoord;in vec2 v_texCrop;in vec2 v_texCropSize;in float v_texId;uniform sampler2D u_tex[MAX_TEXTURES];out vec4 fragColor;";a+="void main(void){";for(var i=-1;i<g;i++){a+=(i>-1?" else ":"")+"if(v_texId<"+(i+1)+".5){";a+=i<0?"fragColor=vec4(0.0,0.0,0.0,0.0);":"vec4 color=vec4(texture(u_tex["+i+"],v_texCrop+v_texCropSize*fract(v_texCoord)).a);fragColor=vec4(vec3(1.0)*((color.r+color.g+color.b)/3.0),color.a);";a+="}"};a+="}";return a});AGL.Stage2D=c4(AGL.BaseRenderer,function r(o,p,q,k){AGL.BaseRenderer.call(this,o,p,q,{"a_position":"getAttribLocation","a_matrix":"getAttribLocation","a_worldMatrix":"getAttribLocation","a_texMatrix":"getAttribLocation","a_texCrop":"getAttribLocation","a_fillColor":"getAttribLocation","a_tintColor":"getAttribLocation","a_effects":"getAttribLocation","u_resolution":"getUniformLocation","u_tex":"getUniformLocation","u_lightPositions":"getUniformLocation","u_lightVolumes":"getUniformLocation","u_lightColors":"getUniformLocation","u_lightEffects":"getUniformLocation","u_lightZIndices":"getUniformLocation","u_fog":"getUniformLocation","u_filters":"getUniformLocation",},k);this.fog=new AGL.ColorProps();this.fog.a=0;this.colorCache=this.color.items;this._DEFAULT_DUO=[0,0];this._DEFAULT_QUAD=[0,0,0,0];this._attachedLights=[];this._pickedElements=[];this._isPickerSet=_fls;this._tempPickerVector=new Float32Array([0,0,1]);this._tempMatrix=new Float32Array(6);this._tempInverseMatrix=new Float32Array(6);if(this._config.isLightEnabled){this._lightPositions=new Float32Array(this._config.lightsNum*2);this._lightVolumes=new Float32Array(this._config.lightsNum*2);this._lightColors=new Float32Array(this._config.lightsNum*4);this._lightEffects=new Float32Array(this._config.lightsNum*4);this._lightZIndices=new Int32Array(this._config.lightsNum)};this._collectLightsFunc=this._config.isLightEnabled?this._collectLights.bind(this):emptyFunction;this._colorData=new Float32Array(this._MAX_BATCH_ITEMS*4);this._colorBuffer=this._createArrayBuffer(this._colorData,"a_fillColor",4,1,4,this._gl.FLOAT,4);this._tintColorData=new Float32Array(this._MAX_BATCH_ITEMS*4);this._tintColorBuffer=this._createArrayBuffer(this._tintColorData,"a_tintColor",4,1,4,this._gl.FLOAT,4);this._effectLength=(this._config.isMaskEnabled?4:3);this._effectData=new Float32Array(this._MAX_BATCH_ITEMS*this._effectLength);this._effectBuffer=this._createArrayBuffer(this._effectData,"a_effects",this._effectLength,1,this._effectLength,this._gl.FLOAT,4);this._setMaskDataFunc=this._config.isMaskEnabled?this._setMaskData.bind(this):emptyFunction;this._zIndexCounter=0;this._resize()},function(j){set(this,"filters",function(f){this._config.filters&&this._config.filters.length>0&&this._gl.uniform1i(this._locations["u_filters"],f)});get(this,"pickedElements",function(){return this._pickedElements.clone()});this.render=function(){this._resize();this._pickedElements.length=0;this._zIndexCounter=0;this._updateColor();this._updateFog();this._collectLightsFunc();this._render();this._isPickerSet=_fls};this.isLightAttached=function(c){return this._attachedLights.has(c)};this.attachLight=function(c){!this.isLightAttached(c)&&this._attachedLights.length<this._config.lightsNum&&this._attachedLights.push(c)};this.detachLight=function(c){this._attachedLights.remove(c)};this.setPickerPoint=function(x,y){this._isPickerSet=_tru;this._tempPickerVector[0]=(x-this._widthHalf)*this.matrixCache[0];this._tempPickerVector[1]=(y-this._heightHalf)*this.matrixCache[4]};this._updateFog=function(){this.fog.isUpdated()&&this._gl.uniform4fv(this._locations["u_fog"],this.fog.items)};this._collectLights=function(){var c;var d;var h;var i;var l;for(i=0,l=this._config.lightsNum;i<l;++i){duoId=i*2;h=i*4;if(i>=this._attachedLights.length||!this._attachedLights[i].renderable){arraySet(this._lightPositions,this._DEFAULT_DUO,duoId);arraySet(this._lightVolumes,this._DEFAULT_DUO,duoId);arraySet(this._lightColors,this._DEFAULT_QUAD,h);arraySet(this._lightEffects,this._DEFAULT_QUAD,h);this._lightZIndices[i]=-1}else{c=this._attachedLights[i];arraySet(this._lightPositions,c.positionCache,duoId);arraySet(this._lightVolumes,c.volumeCache,duoId);arraySet(this._lightColors,c.colorCache,h);arraySet(this._lightEffects,c.effectCache,h);this._lightZIndices[i]=c.props.zIndex}};c=null;this._gl.uniform2fv(this._locations["u_lightPositions"],this._lightPositions);this._gl.uniform2fv(this._locations["u_lightVolumes"],this._lightVolumes);this._gl.uniform4fv(this._locations["u_lightColors"],this._lightColors);this._gl.uniform4fv(this._locations["u_lightEffects"],this._lightEffects);this._gl.uniform1fv(this._locations["u_lightZIndices"],this._lightZIndices)};this._drawItem=function(a,g){if(!a.renderable)return;a.props.zIndex=++this._zIndexCounter;a.update(this._renderTimer,g);a.type!=="item"&&this._drawFunctionMap[a.type](a,g)};this._setMaskData=function(a){a.mask&&(this._effectData[this._batchItems*this._effectLength+3]=this._drawTexture(a.mask))};this._setBufferData=function(a,g,t,b,h,n){j._setBufferData.call(this,a,g,t,b,h);arraySet(this._colorData,g.colorCache,h);arraySet(this._tintColorData,a.colorCache,h);this._effectData[n]=t;this._effectData[n+1]=a.tintType;this._effectData[n+2]=a.props.zIndex};this._drawImage=function(a,g){this._checkBlendMode(a);if(this._isPickerSet&&a.interactive&&AGL.Matrix3.isPointInMatrix(this._tempPickerVector,g.matrixCache,a.matrixCache,this._tempMatrix,this._tempInverseMatrix))this._pickedElements.push(a);this._setMaskDataFunc(a);var t=this._drawTexture(a.texture);this._setBufferData(a,g,t,this._batchItems*9,this._batchItems*4,this._batchItems*this._effectLength);++this._batchItems===this._MAX_BATCH_ITEMS&&this._batchDraw()};this._bindBuffers=function(){j._bindBuffers.call(this);this._bindArrayBuffer(this._colorBuffer,this._colorData);this._bindArrayBuffer(this._tintColorBuffer,this._tintColorData);this._bindArrayBuffer(this._effectBuffer,this._effectData)};this._resize=function(){var m=j._resize.call(this);m&&this._gl.uniform2f(this._locations["u_resolution"],this._width/this._height,100/this._width)};this._updateColor=function(){this.color.isUpdated()&&this.worldColorUpdateId++}});cnst(AGL.Stage2D,"MAX_LIGHT_SOURCES",16);cnst(AGL.Stage2D,"Filters",{"NONE":0,"GRAYSCALE":1,"SEPIA":2,"INVERT":4,"COLORLIMIT":8,"VIGNETTE":16,"RAINBOW":32,"LINES":64,});rof(AGL.Stage2D,"createVertexShader",function(k){var s=k.lightsNum;var e="#version 300 es\n";if(k.isLightEnabled){e+="#define MAX_LIGHT_SOURCES "+s+"\n"};e+="in vec2 a_position;in mat3 a_matrix;in mat3 a_worldMatrix;in mat3 a_texMatrix;in vec4 a_texCrop;in vec4 a_fillColor;in vec4 a_tintColor;in vec"+(k.isMaskEnabled?"4":"3")+" a_effects;";e+="uniform vec2 u_resolution;uniform vec4 u_fog;";if(k.isLightEnabled){e+="uniform vec2 u_lightPositions[MAX_LIGHT_SOURCES];uniform vec2 u_lightVolumes[MAX_LIGHT_SOURCES];uniform vec4 u_lightColors[MAX_LIGHT_SOURCES];uniform vec4 u_lightEffects[MAX_LIGHT_SOURCES];uniform float u_lightZIndices[MAX_LIGHT_SOURCES];"};e+="out vec2 v_texCoord;out vec4 v_coord;out vec2 v_texCrop;out vec2 v_texCropSize;out vec4 v_fillColor;out vec4 v_tintColor;out float v_texId;out float v_tintType;out float v_colorMultiply;out vec4 v_fogColor;";if(k.isMaskEnabled)e+="out float v_maskTexId;";if(k.isLightEnabled){e+="vec4 lightValue(vec4 pos,vec2 lightPosition,vec2 lightVolume,vec4 lightColor,vec4 lightEffect){vec2 dist=pos.xy-lightPosition;return lightColor*lightColor.a*max(0.0,min(1.0,1.0-sqrt(pow(abs(dist.x+(abs(dist.x)*lightEffect.x)),lightEffect.z)*(lightVolume.x/u_resolution.y)+pow(abs(dist.y+(abs(dist.y)*lightEffect.y)),lightEffect.w)*(lightVolume.y/u_resolution.x/u_resolution.y))));}"};e+="void main(void){vec3 pos=vec3(a_position,1.0);gl_Position=vec4((a_worldMatrix*a_matrix*pos).xy,0.0,1.0);v_texCoord=(a_texMatrix*pos).xy;v_coord=gl_Position;v_texCrop=a_texCrop.xy;v_texCropSize=a_texCrop.zw-a_texCrop.xy;v_fillColor=a_fillColor;v_tintColor=a_tintColor;v_texId=a_effects.x;v_tintType=a_effects.y;";e+="vec4 lightColor=vec4(0.0);";if(k.isLightEnabled){for(var i=0;i<s;i++){e+="if(u_lightColors["+i+"].a>0.0 && u_lightZIndices["+i+"]>a_effects.z){lightColor+=lightValue(v_coord,u_lightPositions["+i+"],u_lightVolumes["+i+"],u_lightColors["+i+"],u_lightEffects["+i+"]);}"}};e+="float colorLightMultiply=max(0.0,u_fog.a-lightColor.a);v_colorMultiply=max(0.0,1.0-colorLightMultiply);v_fogColor=vec4(u_fog.rgb*colorLightMultiply,0.0);v_fillColor+=lightColor;";if(k.isMaskEnabled)e+="v_maskTexId=a_effects.w;";e+="}";return e});rof(AGL.Stage2D,"createFragmentShader",function(k){var u=k.textureNum;var e="#version 300 es\n#define MAX_TEXTURES "+u+"\n";e+="precision lowp float;in vec4 v_coord;in vec2 v_texCoord;in vec2 v_texCrop;in vec2 v_texCropSize;in vec4 v_fillColor;in vec4 v_tintColor;in float v_texId;in float v_tintType;in float v_colorMultiply;in vec4 v_fogColor;";if(k.isMaskEnabled)e+="in float v_maskTexId;";e+="uniform sampler2D u_tex[MAX_TEXTURES];";if(k.isFilterEnabled)e+="uniform int u_filters;";e+="out vec4 fragColor;";e+="void main(void){";if(k.isMaskEnabled){e+="float maskAlpha=1.0;if(v_maskTexId>0.0){";for(var i=0;i<u;i++){e+=(i>0?" else ":"")+"if(v_maskTexId<"+(i+1)+".5){maskAlpha=texture(u_tex["+i+"],(v_coord.xy+vec2(1.0,-1.0))/vec2(2.0,-2.0)).r;if(maskAlpha==0.0) discard;}"};e+="}"};for(var i=-1;i<u;i++){e+=(i>-1?" else ":"")+"if(v_texId<"+(i+1)+".5){";e+="fragColor="+(i<0?"vec4(0.0,0.0,0.0,0.0);":"texture(u_tex["+i+"],v_texCrop+v_texCropSize*fract(v_texCoord));");e+="if(fragColor.a==0.0) discard;}"};e+="if(fragColor.a>0.0){if(v_tintType<0.5) fragColor*=v_tintColor;else if(v_tintType<1.5 && fragColor.r==fragColor.g && fragColor.r==fragColor.b) fragColor*=v_tintColor;else if(v_tintType<2.5) fragColor=vec4((fragColor.rgb*(1.0-v_tintColor.a))+(v_tintColor.rgb*v_tintColor.a),fragColor.a);";e+="vec4 finalColor=vec4(fragColor.rgb*v_colorMultiply,fragColor.a);fragColor=(finalColor*v_fillColor)+v_fogColor;";if(k.isFilterEnabled){e+="if(u_filters>0 && fragColor.a>0.0){";for(var i=0;i<k.filters.length;i++){e+="if(("+k.filters[i]+" & u_filters)>0){";switch(k.filters[i]){case AGL.Stage2D.Filters.GRAYSCALE:e+="fragColor=vec4(vec3(1.0)*((fragColor.r+fragColor.g+fragColor.b)/3.0),fragColor.a);";break;case AGL.Stage2D.Filters.SEPIA:e+="fragColor=vec4(vec3(0.874,0.514,0.156)*((fragColor.r+(fragColor.g+fragColor.b))/3.0),fragColor.a);";break;case AGL.Stage2D.Filters.INVERT:e+="fragColor=abs(vec4(fragColor.rgb-1.0,fragColor.a));";break;case AGL.Stage2D.Filters.COLORLIMIT:e+="fragColor=vec4((floor((fragColor.rgb*256.0)/32.0)/256.0)*32.0,fragColor.a);";break;case AGL.Stage2D.Filters.VIGNETTE:e+="float vignetteValue=(1.0-sqrt(pow(v_coord.x,4.0)+pow(v_coord.y,4.0)));fragColor*=vec4(vec3(vignetteValue),1);";break;case AGL.Stage2D.Filters.RAINBOW:e+="fragColor+=vec4(v_coord.x*0.15,v_coord.y*0.15,(v_coord.x-v_coord.y)*0.15,0);";break;case AGL.Stage2D.Filters.LINES:e+="fragColor+=vec4(sin(v_coord.y* 500.0)*0.2);";break};e+="}"};e+="}"};if(k.isMaskEnabled)e+="fragColor.a*=maskAlpha;";e+="}}";return e});}).call({});